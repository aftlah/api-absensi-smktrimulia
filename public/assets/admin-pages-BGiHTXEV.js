import{j as e}from"./query-vendor-CL32O2jR.js";import{r,u as me,a as he,R as ee}from"./router-vendor-CjMceo_z.js";import{S as I}from"./ui-vendor-DAzBgmXi.js";import{a as Le,u as re,w as Ce,r as Me}from"./utils-vendor-BmMXCZbk.js";const Ca={required:a=>!a||typeof a=="string"&&a.trim()===""?"Field ini wajib diisi":null,email:a=>a?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(a)?null:"Format email tidak valid":null,minLength:a=>s=>s&&s.length<a?`Minimal ${a} karakter`:null,maxLength:a=>s=>s&&s.length>a?`Maksimal ${a} karakter`:null,numeric:a=>a&&isNaN(a)?"Harus berupa angka":null,phone:a=>a?/^(\+62|62|0)[0-9]{9,13}$/.test(a.replace(/\s/g,""))?null:"Format nomor telepon tidak valid":null,nis:a=>a?/^\d{8,12}$/.test(a)?null:"NIS harus 8-12 digit angka":null,password:a=>a&&a.length<6?"Password minimal 6 karakter":null,confirmPassword:a=>s=>s&&s!==a?"Konfirmasi password tidak cocok":null},Ma=(a,s)=>{const t={};return Object.keys(s).forEach(n=>{const l=Array.isArray(s[n])?s[n]:[s[n]],h=a[n];for(const g of l){const m=g(h);if(m){t[n]=m;break}}}),{isValid:Object.keys(t).length===0,errors:t}},_a=(a,s={})=>{const{maxSize:t=5*1024*1024,allowedTypes:n=["image/jpeg","image/png","image/jpg","application/pdf"],required:l=!1}=s;return a?a.size>t?`Ukuran file maksimal ${Math.round(t/1024/1024)}MB`:n.includes(a.type)?null:`Tipe file tidak didukung. Gunakan: ${n.join(", ")}`:l?"File wajib dipilih":null},xe=(a,s)=>{const t=[];return()=>{const n=Date.now();for(;t.length>0&&t[0]<=n-s;)t.shift();return t.length>=a?!1:(t.push(n),!0)}},_e="/api",Ie=xe("5","60000"),Ae=xe("100","60000"),x=Le.create({baseURL:_e,timeout:3e4,withCredentials:!0,headers:{Accept:"application/json","Content-Type":"application/json"}});x.interceptors.request.use(a=>{const s=a.url?.includes("/login");return(s?Ie():Ae())?(a.data instanceof FormData&&delete a.headers["Content-Type"],a.metadata={startTime:new Date},a):Promise.reject({response:{status:429,data:{responseMessage:s?"Terlalu banyak percobaan login. Coba lagi dalam 1 menit.":"Terlalu banyak permintaan. Coba lagi nanti."}}})},a=>Promise.reject(a));x.interceptors.response.use(a=>a,a=>{const s=a.response?.status,t=a.config?.url||"";return s===401&&!t.endsWith("/login")&&!t.endsWith("/me")?window.location.href="/login":s===403?console.warn("Access denied:",a.response?.data?.responseMessage):s===429?console.warn("Rate limit exceeded"):s>=500?console.error("Server error:",a.response?.data):s||console.error("Network error - check your connection"),Promise.reject(a)});const Te=(a,s=null)=>{const t=a.response?.status,l={400:"Permintaan tidak valid",401:"Sesi Anda telah berakhir. Silakan login kembali",403:"Anda tidak memiliki akses untuk melakukan tindakan ini",404:"Data tidak ditemukan",422:a.response?.data?.responseMessage||a.message||"Data yang dikirim tidak valid",429:"Terlalu banyak permintaan. Coba lagi nanti",500:"Terjadi kesalahan server. Coba lagi nanti",502:"Server sedang maintenance",503:"Layanan tidak tersedia"};return s||l[t]||"Terjadi kesalahan yang tidak diketahui"},se={login:a=>x.post("/login",a),logout:()=>x.post("/logout"),refresh:()=>x.post("/refresh"),me:()=>x.get("/me"),profile:()=>x.get("/profil"),updateProfile:a=>x.put("/profil",a),resetPassword:a=>x.post("/akun/reset-password",a)},te={absen:a=>x.post("/absensi",a),absenPulang:a=>x.post("/absensi/pulang",a),izinSakit:a=>x.post("/absensi/izinsakit",a),cekJarak:a=>x.post("/absensi/cek-jarak",a),riwayat:()=>x.get("/absensi/riwayat"),riwayatAbsenHariIni:()=>x.get("/absensi/hariini")},U={rekap:a=>x.get("/admin/rekap",{params:a}),getSettings:()=>x.get("/admin/pengaturan"),updateSettings:a=>x.put("/admin/pengaturan",a),updateMyProfile:a=>x.put("/admin/profil",a),getJurusan:a=>x.get("/admin/jurusan",{params:a}),createJurusan:a=>x.post("/admin/jurusan",a),updateJurusan:(a,s)=>x.put(`/admin/jurusan/${a}`,s),deleteJurusan:a=>x.delete(`/admin/jurusan/${a}`),deleteAllJurusan:()=>x.delete("/admin/jurusan-delete-all"),getKelas:()=>x.get("/admin/kelas"),createKelas:a=>x.post("/admin/kelas",a),updateKelas:(a,s)=>x.put(`/admin/kelas/${a}`,s),deleteKelas:a=>x.delete(`/admin/kelas/${a}`),deleteAllKelas:()=>x.delete("/admin/kelas-delete-all"),getRiwayatKelas:a=>x.get("/admin/riwayat-kelas",{params:a}),updateRiwayatKelas:(a,s)=>x.put(`/admin/riwayat-kelas/${a}`,s),promoteClass:(a,s)=>x.post(`/admin/riwayat-kelas/promote/${a}`,s),getWaliKelas:()=>x.get("/admin/wali-kelas"),createWaliKelas:a=>x.post("/admin/wali-kelas",a),updateWaliKelas:(a,s)=>x.put(`/admin/wali-kelas/${a}`,s),deleteWaliKelas:a=>x.delete(`/admin/wali-kelas/${a}`),deleteAllWaliKelas:()=>x.delete("/admin/wali-kelas-delete-all"),getGuruPiket:()=>x.get("/admin/guru-piket"),createGuruPiket:a=>x.post("/admin/guru-piket",a),updateGuruPiket:(a,s)=>x.put(`/admin/guru-piket/${a}`,s),deleteGuruPiket:a=>x.delete(`/admin/guru-piket/${a}`),deleteAllGuruPiket:()=>x.delete("/admin/guru-piket-delete-all"),getJadwalPiket:()=>x.get("/admin/jadwal-piket"),createJadwalPiket:a=>x.post("/admin/jadwal-piket",a),updateJadwalPiket:(a,s)=>x.put(`/admin/jadwal-piket/${a}`,s),deleteJadwalPiket:a=>x.delete(`/admin/jadwal-piket/${a}`),deleteAllJadwalPiket:()=>x.delete("/admin/jadwal-piket-delete-all"),importSiswa:(a,s)=>x.post("/admin/import-siswa",a,{onUploadProgress:s}),getDataSiswa:a=>x.get("/admin/kelola-datasiswa",{params:a}),createSiswa:a=>x.post("/admin/kelola-datasiswa/create",a),updateSiswa:(a,s)=>x.post("/admin/kelola-datasiswa/update",{siswa_id:a,...s}),deleteSiswa:a=>x.delete(`/admin/kelola-datasiswa/${a}`),deleteAllSiswa:()=>x.delete("/admin/kelola-datasiswa/delete-all")},ie={laporan:()=>x.get("/guru/laporan"),walasInfo:()=>x.get("/walas/info"),aktifitasTerbaru:()=>x.get("/aktivitas-terbaru"),getSiswaIzinSakit:()=>x.get("/absensi/siswaIzinSakit"),updateAbsensiStatus:a=>x.post("/absensi/updateStatus",a),updateAbsensiStatusAll:a=>x.post("/absensi/updateAbsensiStatus",a),lihatAbsensiSiswa:a=>x.get("/absensi/lihat",{params:a}),lihatAbsensiHariIni:()=>x.get("/absensi/hari-ini"),getRencanaAbsensi:()=>x.get("/absensi/rencana"),createRencanaAbsensi:a=>x.post("/absensi/rencana",a),updateRencanaStatusHari:a=>x.post("/absensi/rencana/update-status",a)},Q={totalSiswa:()=>x.get("/total-siswa"),siswaHadirHariIni:()=>x.get("/hadir-hariini"),siswaTerlambatHariIni:()=>x.get("/terlambat-hariini"),siswaIzinHariIni:()=>x.get("/izin-hariini"),siswaSakitHariIni:()=>x.get("/sakit-hariini"),getPengaturan:()=>x.get("/pengaturan")},ge={listKelas:()=>x.get("/utility/kelas"),getDataSiswa:a=>x.get("/utility/siswa",{params:a})},pe=r.createContext(),De=()=>{const a=r.useContext(pe);if(!a)throw new Error("useAuth must be used within an AuthProvider");return a},Ia=({children:a})=>{const[s,t]=r.useState(null),[n,l]=r.useState(!0),[h,g]=r.useState(!1);r.useEffect(()=>{if(h)return;(async()=>{try{const b=await se.me();b.data.responseStatus?t(b.data.responseData):t(null)}catch(b){console.log("No valid session found:",b.response?.status),t(null)}finally{l(!1),g(!0)}})()},[h]);const m=async M=>{try{const P=(await se.login(M)).data;if(P.responseStatus){const C=P?.responseData?.user??P?.responseData;return t(C),{success:!0,data:C}}else return{success:!1,message:P.responseMessage}}catch(b){if(b.response?.status===403&&b.response?.data?.responseMessage?.includes("Jadwal Piket")){const C=b.response.data.errors;return I.fire({icon:"error",title:"Akses Ditolak",html:`
            <div class="text-left">
              <p class="mb-3 text-red-600 font-semibold">ğŸš« Anda tidak terjadwal sebagai guru piket hari ini</p>
              
              <div class="bg-blue-50 border border-blue-200 rounded-lg p-4 mb-4">
                <h4 class="font-semibold text-blue-800 mb-2">ğŸ“… Informasi Hari Ini:</h4>
                <div class="space-y-1 text-sm">
                  <div><strong>Hari:</strong> ${C.hari_ini}</div>
                  <div><strong>Tanggal:</strong> ${C.tanggal_ini}</div>
                  ${C.guru_piket_hari_ini?`<div><strong>Guru Piket Hari Ini:</strong> ${C.guru_piket_hari_ini.nama} (${C.guru_piket_hari_ini.username})</div>`:"<div><strong>Guru Piket Hari Ini:</strong> Tidak ada yang terjadwal</div>"}
                </div>
              </div>
              
              ${C.jadwal_terdekat?`<div class="bg-green-50 border border-green-200 rounded-lg p-4 mb-4">
                    <h4 class="font-semibold text-green-800 mb-2">ğŸ“‹ Jadwal Piket Anda Berikutnya:</h4>
                    <div class="text-sm">
                      <div><strong>Hari:</strong> ${C.jadwal_terdekat.hari}</div>
                      <div><strong>Tanggal:</strong> ${C.jadwal_terdekat.tanggal_formatted}</div>
                    </div>
                  </div>`:`<div class="bg-orange-50 border border-orange-200 rounded-lg p-4">
                    <h4 class="font-semibold text-orange-800 mb-2">âš ï¸ Perhatian:</h4>
                    <p class="text-sm text-orange-700">
                      Anda belum memiliki jadwal piket yang terdaftar. 
                      Silakan hubungi admin untuk mengatur jadwal piket Anda.
                    </p>
                  </div>`}
            </div>
          `,confirmButtonText:"Mengerti",confirmButtonColor:"#dc2626",width:500,allowOutsideClick:!1,allowEscapeKey:!1}),{success:!1,message:b.response.data.responseMessage,isScheduleError:!0}}return{success:!1,message:Te(b,"Gagal login. Periksa username dan password Anda.")}}},i=async()=>{try{await se.logout()}catch(M){console.error("Logout error:",M)}finally{t(null)}},f={user:s,loading:n,login:m,logout:i,refreshToken:async()=>{try{return!!(await se.refresh()).data.responseStatus}catch(M){return console.error("Token refresh error:",M),i(),!1}},isAuthenticated:!!s};return e.jsx(pe.Provider,{value:f,children:a})},Aa=({message:a})=>e.jsx("div",{className:"flex flex-col min-h-screen",children:e.jsx("main",{className:"flex items-center justify-center flex-grow",children:e.jsxs("div",{className:"p-6 text-red-700 bg-red-100 border border-red-400 rounded-lg",children:[e.jsx("h2",{className:"mb-2 text-lg font-semibold",children:"Terjadi Kesalahan"}),e.jsx("p",{className:"text-sm",children:a??"Gagal memuat data. Silakan coba lagi nanti."})]})})}),Pe=({size:a="large",text:s="Memuat...",fullScreen:t=!0,overlay:n=!1})=>{const l={small:"h-6 w-6",medium:"h-8 w-8",large:"h-12 w-12"},h=()=>e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:`animate-spin rounded-full border-b-2 border-[#003366] mx-auto ${l[a]}`}),s&&e.jsx("p",{className:"mt-4 text-gray-600",children:s})]});return n?e.jsx("div",{className:"absolute inset-0 bg-white bg-opacity-75 flex items-center justify-center z-50",children:e.jsx(h,{})}):t?e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsx(h,{})}):e.jsx(h,{})},Ta=({loading:a,children:s,className:t="",disabled:n,...l})=>e.jsxs("button",{className:`relative ${t} ${a?"cursor-not-allowed opacity-75":""}`,disabled:a||n,...l,children:[a&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-2 border-white border-t-transparent"})}),e.jsx("span",{className:a?"invisible":"visible",children:s})]}),Da=a=>a.toLocaleDateString("id-ID",{weekday:"long",year:"numeric",month:"long",day:"numeric"}),Pa=()=>{const[a,s]=r.useState(!1),[t,n]=r.useState(null);return{handleAbsen:async(m,i)=>{s(!0),n(null);try{return{success:!0,data:(m==="pulang"?await te.absenPulang(i):await te.absen(i)).data}}catch(c){const f=c.response?.data;if(c.response?.status===422&&f?.responseMessage?.includes("radius")){const M=f?.errors?.distance||null;return{success:!1,message:f.responseMessage,distance:M}}return{success:!1,message:f?.responseMessage||"Terjadi kesalahan pada server"}}finally{s(!1)}},handleSakit:async m=>{s(!0),n(null);try{return{success:!0,data:(await te.izinSakit(m)).data}}catch(i){const c=i.response?.data;return n(c?.message||c?.responseMessage||"Terjadi kesalahan pada server"),{success:!1,message:c?.message||c?.responseMessage||"Terjadi kesalahan pada server",errors:c?.errors||null}}finally{s(!1)}},handleIzin:async m=>{s(!0),n(null);try{return{success:!0,data:(await te.izinSakit(m)).data}}catch(i){const c=i.response?.data;return n(c?.message||c?.responseMessage||"Terjadi kesalahan pada server"),{success:!1,message:c?.message||c?.responseMessage||"Terjadi kesalahan pada server",errors:c?.errors||null}}finally{s(!1)}},loading:a,error:t}},$a=()=>{const[a,s]=r.useState(!0),[t,n]=r.useState(null);return{handleTotalSiswa:async()=>{s(!0),n(null);try{const c=await Q.totalSiswa(),{responseStatus:f,responseMessage:M,responseData:b}=c.data;return f?!b||typeof b.total_siswa!="number"?(n("Invalid data received"),null):b.total_siswa:(n(M||"Failed to fetch total siswa"),null)}catch(c){return console.error("Error fetching total siswa:",c),n("Failed to fetch total siswa"),null}finally{s(!1)}},handleSiswaHadirHariIni:async()=>{s(!0),n(null);try{const c=await Q.siswaHadirHariIni(),{responseStatus:f,responseMessage:M,responseData:b}=c.data;return f?!b||typeof b.total_hadir!="number"?(n("Invalid data received"),null):b.total_hadir:(n(M||"Failed to fetch siswa hadir hari ini"),null)}catch{return n("Failed to fetch siswa izin hari ini"),null}finally{s(!1)}},handleSiswaTerlambat:async()=>{s(!0),n(null);try{const c=await Q.siswaTerlambatHariIni(),{responseStatus:f,responseMessage:M,responseData:b}=c.data;return f?!b||typeof b.total_terlambat!="number"?(n("Invalid data received"),null):b.total_terlambat:(n(M||"Failed to fetch siswa terlambat"),null)}catch(c){return console.error("Error fetching siswa terlambat:",c),n("Failed to fetch siswa terlambat"),null}finally{s(!1)}},handleSiswaIzinHariIni:async()=>{s(!0),n(null);try{const c=await Q.siswaIzinHariIni(),{responseStatus:f,responseMessage:M,responseData:b}=c.data;return f?!b||typeof b.total_izin!="number"?(n("Invalid data received"),null):b.total_izin:(n(M||"Failed to fetch siswa izin"),null)}catch{return n("Failed to fetch siswa izin"),null}finally{s(!1)}},handleSiswaSakitHariIni:async()=>{s(!0),n(null);try{const c=await Q.siswaSakitHariIni(),{responseStatus:f,responseMessage:M,responseData:b}=c.data;return f?!b||typeof b.total_sakit!="number"?(n("Invalid data received"),null):b.total_sakit:(n(M||"Failed to fetch siswa sakit"),null)}catch(c){return console.error("Error fetching siswa sakit:",c),n("Failed to fetch siswa sakit"),null}finally{s(!1)}},loading:a,error:t}},Ba=(a,s=1e3)=>{const[t,n]=r.useState(0);return r.useEffect(()=>{let l=0;const h=a/(s/16),g=setInterval(()=>{l+=h,l>=a&&(l=a,clearInterval(g)),n(Math.floor(l))},16);return()=>clearInterval(g)},[a,s]),t},za=()=>{const[a,s]=r.useState([]),[t,n]=r.useState(!0),[l,h]=r.useState(null),g=r.useCallback(async()=>{try{n(!0);const i=await ie.getRencanaAbsensi();i.data.responseStatus?s(i.data.responseData):h(i.data.responseMessage||"Gagal memuat data")}catch(i){h(i.message||"Terjadi kesalahan saat memuat data")}finally{n(!1)}},[]),m=r.useCallback(async()=>{await g()},[g]);return r.useEffect(()=>{g()},[g]),{data:a,loading:t,error:l,refreshData:m}},Ha=a=>{const[s,t]=r.useState({tanggal:"",keterangan:"",mode:"single"}),n=r.useCallback(g=>{const{name:m,value:i}=g.target;t(c=>({...c,[m]:i}))},[]),l=r.useCallback(()=>{t({tanggal:"",keterangan:"",mode:"single"})},[]),h=r.useCallback(async g=>{g.preventDefault();try{const m={tanggal:s.tanggal,keterangan:s.keterangan,mode:s.mode},i=await ie.createRencanaAbsensi(m);return i.data.responseStatus?(await a(),l(),{success:!0,message:"Rencana absensi berhasil ditambahkan!"}):{success:!1,message:i.data.responseMessage||"Gagal menambahkan data"}}catch{return{success:!1,message:"Terjadi kesalahan saat mengirim data"}}},[s,a,l]);return{formData:s,handleChange:n,handleSubmit:h,resetForm:l}},$e=(a,s)=>s==="admin"||s==="kepala_sekolah"?[{key:"home",label:"Beranda",href:"/dashboard",icon:"HomeIcon"},{key:"rekap",label:"Rekap",href:"/dashboard/rekap",icon:"CalendarIcon"},{key:"kelola sekolah",label:"Kelola Sekolah",icon:"SchoolIcon",children:[{key:"jurusan",label:"Jurusan",href:"/dashboard/jurusan",icon:"BookOpenIcon"},{key:"wali-kelas",label:"Wali Kelas",href:"/dashboard/wali-kelas",icon:"UsersIcon"},{key:"kelas",label:"Kelas",href:"/dashboard/kelas",icon:"BuildingIcon"},{key:"guru-piket",label:"Guru Piket",href:"/dashboard/guru-piket",icon:"UsersIcon"},{key:"jadwal-piket",label:"Jadwal Piket",href:"/dashboard/jadwal-piket",icon:"ClockIcon"},{key:"import-siswa",label:"Import Data Siswa",href:"/dashboard/import-siswa",icon:"UploadIcon"},{key:"kelola-siswa",label:"Kelola Data Siswa",href:"/dashboard/kelola-siswa",icon:"UsersIcon"},{key:"riwayat-kelas",label:"Riwayat Kelas",href:"/dashboard/riwayat-kelas",icon:"HistoryIcon"}]},{key:"pengaturan",label:"Pengaturan Sistem",href:"/dashboard/pengaturan",icon:"SettingsIcon"},{key:"profil",label:"Profil",href:"/profil",icon:"UserIcon"},{key:"logout",label:"Logout",href:"#",icon:"LogoutIcon",onClick:a}]:s==="walas"?[{key:"home",label:"Beranda",href:"/dashboard",icon:"HomeIcon"},{key:"rekap-walas",label:"Rekap Absensi",href:"/dashboard/rekap-walas",icon:"CalendarIcon"},{key:"profil",label:"Profil",href:"/profil",icon:"UserIcon"},{key:"logout",label:"Logout",href:"#",icon:"LogoutIcon",onClick:a}]:[{key:"home",label:"Beranda",href:"/dashboard",icon:"HomeIcon"},{key:"absensi",label:"Absensi",icon:"CheckIcon",children:[{key:"rencana-absensi",label:"Rencana Absensi",href:"/dashboard/rencana-absensi",icon:"CalendarPlusIcon"},{key:"absen-hari-ini",label:"Absen Hari Ini",href:"/dashboard/absensi-hari-ini",icon:"CalendarCheckIcon"},{key:"izin-sakit",label:"Izin / Sakit",href:"/dashboard/siswa-izinsakit",icon:"HeartHandshakeIcon"},{key:"lihat-absensi",label:"Lihat Absensi",href:"/dashboard/lihat-absensi",icon:"EyeIcon"}]},{key:"profil",label:"Profil",href:"/profil",icon:"UserIcon"},{key:"logout",label:"Logout",href:"#",icon:"LogoutIcon",onClick:a}],le={SettingsIcon:()=>e.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",children:[e.jsx("path",{d:"M12 15a3 3 0 1 0 0-6 3 3 0 0 0 0 6Z",stroke:"#cfe6ff",strokeWidth:"1.6"}),e.jsx("path",{d:"M19.4 15a1.6 1.6 0 0 0 .32 1.76l.06.06a2 2 0 0 1-2.83 2.83l-.06-.06a1.6 1.6 0 0 0-1.76-.32 1.6 1.6 0 0 0-1 1.46V21a2 2 0 0 1-4 0v-.05a1.6 1.6 0 0 0-1-1.46 1.6 1.6 0 0 0-1.76.32l-.06.06a2 2 0 0 1-2.83-2.83l.06-.06a1.6 1.6 0 0 0 .32-1.76 1.6 1.6 0 0 0-1.46-1H3a2 2 0 0 1 0-4h.05a1.6 1.6 0 0 0 1.46-1 1.6 1.6 0 0 0-.32-1.76l-.06-.06a2 2 0 0 1 2.83-2.83l.06.06a1.6 1.6 0 0 0 1.76.32 1.6 1.6 0 0 0 1-1.46V3a2 2 0 0 1 4 0v.05a1.6 1.6 0 0 0 1 1.46 1.6 1.6 0 0 0 1.76-.32l.06-.06a2 2 0 0 1 2.83 2.83l-.06.06a1.6 1.6 0 0 0-.32 1.76 1.6 1.6 0 0 0 1.46 1H21a2 2 0 0 1 0 4h-.05a1.6 1.6 0 0 0-1.46 1Z",stroke:"#cfe6ff",strokeWidth:"1.6",strokeLinecap:"round",strokeLinejoin:"round"})]}),HomeIcon:()=>e.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",children:[e.jsx("path",{d:"M3 10.5L12 4l9 6.5",stroke:"#cfe6ff",strokeWidth:"1.6",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M5 21V11.5h14V21",stroke:"#cfe6ff",strokeWidth:"1.6",strokeLinecap:"round",strokeLinejoin:"round"})]}),CheckIcon:()=>e.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",children:e.jsx("path",{d:"M20 6L9 17l-5-5",stroke:"#cfe6ff",strokeWidth:"1.6",strokeLinecap:"round",strokeLinejoin:"round"})}),CalendarIcon:()=>e.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",children:[e.jsx("rect",{x:"3",y:"5",width:"18",height:"16",rx:"2",stroke:"#cfe6ff",strokeWidth:"1.6"}),e.jsx("path",{d:"M16 3v4M8 3v4",stroke:"#cfe6ff",strokeWidth:"1.6",strokeLinecap:"round"})]}),UsersIcon:()=>e.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",children:[e.jsx("path",{d:"M17 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",stroke:"#cfe6ff",strokeWidth:"1.6",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("circle",{cx:"12",cy:"7",r:"4",stroke:"#cfe6ff",strokeWidth:"1.6"})]}),UserIcon:()=>e.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",children:[e.jsx("circle",{cx:"12",cy:"8",r:"3",stroke:"#cfe6ff",strokeWidth:"1.6"}),e.jsx("path",{d:"M6 20v-1a6 6 0 0 1 12 0v1",stroke:"#cfe6ff",strokeWidth:"1.6",strokeLinecap:"round"})]}),LogoutIcon:()=>e.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",children:[e.jsx("path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",stroke:"#cfe6ff",strokeWidth:"1.6",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M16 17l5-5-5-5",stroke:"#cfe6ff",strokeWidth:"1.6",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M21 12H9",stroke:"#cfe6ff",strokeWidth:"1.6",strokeLinecap:"round",strokeLinejoin:"round"})]}),SchoolIcon:()=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1",strokeLinecap:"round",strokeLinejoin:"round",className:"lucide lucide-school-icon lucide-school",children:[e.jsx("path",{d:"M14 21v-3a2 2 0 0 0-4 0v3"}),e.jsx("path",{d:"M18 5v16"}),e.jsx("path",{d:"m4 6 7.106-3.79a2 2 0 0 1 1.788 0L20 6"}),e.jsx("path",{d:"m6 11-3.52 2.147a1 1 0 0 0-.48.854V19a2 2 0 0 0 2 2h16a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-5a1 1 0 0 0-.48-.853L18 11"}),e.jsx("path",{d:"M6 5v16"}),e.jsx("circle",{cx:"12",cy:"9",r:"2"})]}),BookOpenIcon:()=>e.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",children:[e.jsx("path",{d:"M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z",stroke:"#cfe6ff",strokeWidth:"1.6",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z",stroke:"#cfe6ff",strokeWidth:"1.6",strokeLinecap:"round",strokeLinejoin:"round"})]}),UserCheckIcon:()=>e.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",children:[e.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",stroke:"#cfe6ff",strokeWidth:"1.6",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("circle",{cx:"9",cy:"7",r:"4",stroke:"#cfe6ff",strokeWidth:"1.6"}),e.jsx("path",{d:"m16 11 2 2 4-4",stroke:"#cfe6ff",strokeWidth:"1.6",strokeLinecap:"round",strokeLinejoin:"round"})]}),BuildingIcon:()=>e.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",children:[e.jsx("rect",{x:"4",y:"2",width:"16",height:"20",rx:"2",stroke:"#cfe6ff",strokeWidth:"1.6",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M9 22v-4h6v4",stroke:"#cfe6ff",strokeWidth:"1.6",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M8 6h.01M16 6h.01M8 10h.01M16 10h.01M8 14h.01M16 14h.01",stroke:"#cfe6ff",strokeWidth:"1.6",strokeLinecap:"round",strokeLinejoin:"round"})]}),ShieldIcon:()=>e.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",children:e.jsx("path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z",stroke:"#cfe6ff",strokeWidth:"1.6",strokeLinecap:"round",strokeLinejoin:"round"})}),ClockIcon:()=>e.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",children:[e.jsx("circle",{cx:"12",cy:"12",r:"10",stroke:"#cfe6ff",strokeWidth:"1.6"}),e.jsx("path",{d:"M12 6v6l4 2",stroke:"#cfe6ff",strokeWidth:"1.6",strokeLinecap:"round",strokeLinejoin:"round"})]}),UploadIcon:()=>e.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",children:[e.jsx("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",stroke:"#cfe6ff",strokeWidth:"1.6",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M17 8l-5-5-5 5",stroke:"#cfe6ff",strokeWidth:"1.6",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M12 3v12",stroke:"#cfe6ff",strokeWidth:"1.6",strokeLinecap:"round",strokeLinejoin:"round"})]}),HistoryIcon:()=>e.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",children:[e.jsx("path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",stroke:"#cfe6ff",strokeWidth:"1.6",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M3 3v5h5",stroke:"#cfe6ff",strokeWidth:"1.6",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M12 7v5l4 2",stroke:"#cfe6ff",strokeWidth:"1.6",strokeLinecap:"round",strokeLinejoin:"round"})]}),CalendarCheckIcon:()=>e.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",children:[e.jsx("rect",{x:"3",y:"4",width:"18",height:"18",rx:"2",ry:"2",stroke:"#cfe6ff",strokeWidth:"1.6"}),e.jsx("path",{d:"M16 2v4M8 2v4",stroke:"#cfe6ff",strokeWidth:"1.6",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M3 10h18",stroke:"#cfe6ff",strokeWidth:"1.6",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"m9 16 2 2 4-4",stroke:"#cfe6ff",strokeWidth:"1.6",strokeLinecap:"round",strokeLinejoin:"round"})]}),HeartHandshakeIcon:()=>e.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",children:[e.jsx("path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.29 1.51 4.04 3 5.5",stroke:"#cfe6ff",strokeWidth:"1.6",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M12 5L8 21l4-7 4 7-4-16",stroke:"#cfe6ff",strokeWidth:"1.6",strokeLinecap:"round",strokeLinejoin:"round"})]}),EyeIcon:()=>e.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",children:[e.jsx("path",{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z",stroke:"#cfe6ff",strokeWidth:"1.6",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("circle",{cx:"12",cy:"12",r:"3",stroke:"#cfe6ff",strokeWidth:"1.6"})]}),CalendarPlusIcon:()=>e.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",children:[e.jsx("rect",{x:"3",y:"4",width:"18",height:"18",rx:"2",ry:"2",stroke:"#cfe6ff",strokeWidth:"1.6"}),e.jsx("path",{d:"M16 2v4M8 2v4",stroke:"#cfe6ff",strokeWidth:"1.6",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M3 10h18",stroke:"#cfe6ff",strokeWidth:"1.6",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M10 16h4M12 14v4",stroke:"#cfe6ff",strokeWidth:"1.6",strokeLinecap:"round",strokeLinejoin:"round"})]})};function Be({defaultCollapsed:a=!1,onToggle:s,isMobileOpen:t=!1,onMobileToggle:n}){const[l,h]=r.useState(a),[g,m]=r.useState(new Set),[i,c]=r.useState(!1),{logout:f,user:M}=De(),b=me(),P=he();r.useEffect(()=>{const w=()=>{c(window.innerWidth<1024)};return w(),window.addEventListener("resize",w),()=>window.removeEventListener("resize",w)},[]);const C=ee.useCallback(async()=>{(await I.fire({title:"Konfirmasi Logout",text:"Anda yakin ingin keluar dari aplikasi?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#003366",cancelButtonColor:"#6b7280",confirmButtonText:"Ya, keluar",cancelButtonText:"Batal"})).isConfirmed&&(f(),b("/login"))},[f,b]),R=ee.useMemo(()=>$e(C,M?.role),[C,M?.role]),E=w=>P.pathname===w,F=w=>w?.some(v=>P.pathname===v.href);r.useEffect(()=>{const w=R.find(v=>v.children&&v.children.some(d=>P.pathname===d.href));w&&m(v=>{if(v.has(w.key))return v;const d=new Set(v);return d.add(w.key),d})},[P.pathname,R]);const K=w=>{if(w.children){m(v=>{const d=new Set(v);return d.has(w.key)?d.delete(w.key):d.add(w.key),d});return}if(w.key==="logout"){w.onClick?.();return}b(w.href),n&&n(!1)};return e.jsxs(e.Fragment,{children:[t&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-10 lg:hidden",onClick:()=>n&&n(!1)}),e.jsxs("aside",{className:`fixed top-0 left-0 flex flex-col bg-slate-900 text-slate-100 transition-all duration-200 z-20
        ${i?(t?"translate-x-0":"-translate-x-full")+" w-[260px]":(l?"w-[72px]":"w-[260px]")+" translate-x-0"} h-screen p-3`,children:[e.jsx("div",{className:"flex items-center gap-3 p-2",children:!l&&e.jsxs("div",{children:[e.jsx("h1",{className:"font-bold text-base whitespace-nowrap",children:"SMK TRIMULIA JAKARTA"}),e.jsx("p",{className:"text-sm",children:"SISENUS - Sistem Absensi Radius"})]})}),e.jsx("nav",{className:"flex-1 overflow-y-auto",children:R.map(w=>{const v=E(w.href)||F(w.children);return e.jsxs("div",{children:[e.jsxs("div",{onClick:()=>{w.children?m(d=>{const k=new Set(d);return k.has(w.key)?k.delete(w.key):k.add(w.key),k}):K(w)},className:`flex items-center justify-between px-2 py-2.5 rounded-md cursor-pointer transition-colors 
                ${v?"bg-blue-600/30 text-white":"text-slate-300 hover:bg-white/5"}`,children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-7 flex justify-center",children:le[w.icon]()}),!l&&!i&&e.jsx("span",{className:`text-sm ${v?"font-semibold":""}`,children:w.label}),i&&e.jsx("span",{className:`text-sm ${v?"font-semibold":""}`,children:w.label})]}),w.children&&!l&&!i&&e.jsx("div",{className:"text-xs",children:g.has(w.key)?"â–¾":"â–¸"}),w.children&&i&&e.jsx("div",{className:"text-xs",children:g.has(w.key)?"â–¾":"â–¸"})]}),w.children&&(!i&&!l||i)&&g.has(w.key)&&e.jsx("div",{className:"ml-7 mt-1",children:w.children.map(d=>e.jsxs("div",{onClick:()=>b(d.href),className:`flex items-center gap-3 px-2 py-2 rounded-md text-sm cursor-pointer transition 
                      ${E(d.href)?"bg-blue-600/40 text-white":"text-slate-400 hover:bg-white/5"}`,children:[d.icon&&e.jsx("div",{className:"w-4 flex justify-center",children:le[d.icon]()}),e.jsx("span",{children:d.label})]},d.key))})]},w.key)})}),e.jsx("div",{className:"text-xs text-blue-300 px-2 py-2"})]})]})}const Ea=({children:a})=>{const[s,t]=r.useState(!1),[n,l]=r.useState(!1),[h,g]=r.useState(!1);r.useEffect(()=>{const i=()=>{g(window.innerWidth<1024)};return i(),window.addEventListener("resize",i),()=>window.removeEventListener("resize",i)},[]);const m=i=>{l(typeof i=="boolean"?i:c=>!c)};return e.jsxs("div",{className:"flex bg-gray-50 min-h-screen",children:[e.jsx(Be,{defaultCollapsed:s,onToggle:()=>t(i=>!i),isMobileOpen:n,onMobileToggle:m}),e.jsxs("main",{className:`
          flex-1 transition-all duration-200 overflow-y-auto
          ${h?"ml-0":s?"ml-[72px]":"ml-[260px] mt-4"}
        `,children:[h&&e.jsx("div",{className:"lg:hidden bg-white shadow-sm border-b p-4",children:e.jsx("button",{onClick:()=>m(),className:"bg-slate-900 text-white p-2 rounded-md shadow-lg","aria-label":"Toggle menu",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})})}),e.jsx("div",{className:h?"p-4":"",children:a})]})]})},ze=({notification:a})=>a?e.jsxs("div",{className:`fixed top-6 right-6 z-50 flex items-center gap-3 px-5 py-3 rounded-lg shadow-xl text-white font-medium transition-transform transform ${a.type==="success"?"bg-green-600 animate-slideIn":"bg-red-600 animate-slideIn"}`,children:[e.jsx("span",{className:"text-xl",children:a.type==="success"?"âœ…":"âš ï¸"}),e.jsx("span",{children:a.message})]}):null,Ga=({show:a,onClose:s,formData:t,onChange:n,onSubmit:l})=>{if(!a)return null;const h=new Date().toISOString().split("T")[0],g=()=>{if(!t.tanggal)return"";const m=new Date(t.tanggal+"T00:00:00"),i=new Date(m);i.setDate(m.getDate()+29);const c=["Januari","Februari","Maret","April","Mei","Juni","Juli","Agustus","September","Oktober","November","Desember"],f=m.getDate(),M=i.getDate(),b=c[i.getMonth()],P=i.getFullYear();return`Rencana absensi akan dibuat untuk tanggal ${f}â€“${M} ${b} ${P}.`};return e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-md p-6 animate-fadeIn",children:[e.jsx("h2",{className:"text-2xl font-bold mb-4 text-gray-800",children:"Tambah Rencana Absensi"}),e.jsxs("form",{onSubmit:l,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Tanggal"}),e.jsx("input",{type:"date",name:"tanggal",value:t.tanggal,onChange:n,required:!0,min:h,className:"w-full border rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-400"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Buat selama 30 hari ke depan"}),e.jsxs("select",{name:"mode",value:t.mode,onChange:n,className:"w-full border rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-400",children:[e.jsx("option",{value:"single",children:"Tidak"}),e.jsx("option",{value:"week",children:"Ya"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Keterangan (opsional)"}),e.jsx("textarea",{name:"keterangan",value:t.keterangan,onChange:n,className:"w-full border rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-400"})]}),t.mode==="week"&&t.tanggal&&e.jsx("div",{className:"text-sm text-gray-700 bg-gray-50 border rounded-lg px-3 py-2",children:g()}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-3",children:[e.jsx("button",{type:"button",onClick:s,className:"px-4 py-2 border rounded-lg hover:bg-gray-100 transition",children:"Batal"}),e.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition",children:"Simpan"})]})]})]})})},Ra=({data:a,onUpdated:s})=>{const t=a.reduce((d,k)=>(d[k.tanggal]||(d[k.tanggal]=[]),d[k.tanggal].push(k),d),{});if(Object.keys(t).length===0)return e.jsx("p",{className:"text-gray-600 text-center py-10 bg-gray-50 rounded-lg",children:"Belum ada data rencana absensi."});const n=r.useMemo(()=>Object.entries(t).sort((d,k)=>new Date(d[0])-new Date(k[0])),[t]),l=(()=>{const d=new Date,k=d.getFullYear(),N=String(d.getMonth()+1).padStart(2,"0"),L=String(d.getDate()).padStart(2,"0");return`${k}-${N}-${L}`})(),h=r.useMemo(()=>n.filter(([d])=>String(d)>=l),[n,l]),g=7,[m,i]=r.useState(1),c=Math.max(1,Math.ceil(h.length/g)),f=(m-1)*g,M=h.slice(f,f+g),b=d=>new Date(d).toLocaleDateString("id-ID",{weekday:"long",year:"numeric",month:"long",day:"numeric"}),P=d=>{if(!d)return"";const k=String(d);return/^\d{8}$/.test(k)?`${k.slice(0,4)}/${k.slice(4,8)}`:(/^\d{4}\/\d{4}$/.test(k),k)},C=d=>{let k=0,N=0,L=0;for(const u of d)u.status_hari==="normal"?k+=1:u.status_hari==="libur"?N+=1:L+=1;return{normal:k,libur:N,lainnya:L,total:d.length}},[R,E]=r.useState(null),[F,K]=r.useState("normal"),[w,v]=r.useState("");return e.jsxs("div",{className:"space-y-6",children:[M.map(([d,k])=>e.jsxs("div",{className:"bg-white shadow-md rounded-2xl p-6 hover:shadow-lg transition border border-gray-100",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h2",{className:"text-lg font-semibold text-blue-700",children:[b(d)," ",e.jsxs("span",{className:"ml-2 text-sm text-gray-600",children:["Tahun ajaran: ",P(k[0]?.thn_ajaran)]})]}),e.jsx("button",{className:"ml-3 px-3 py-1.5 text-xs font-medium rounded-lg border border-blue-200 text-blue-700 hover:bg-blue-50",onClick:()=>{E(d);const N=C(k),L=N.libur===N.total?"libur":N.normal===N.total?"normal":"";K(L),v("")},children:"Edit Status Hari"})]}),!1,e.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:k.map((N,L)=>e.jsxs("div",{className:"rounded-xl p-4 bg-gradient-to-br from-gray-50 to-white border border-gray-200 ",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("p",{className:"font-medium text-gray-800",children:[N.kelas.tingkat," ",N.kelas.jurusan.nama_jurusan,N.kelas.paralel!==null?`-${N.kelas.paralel}`:""]}),e.jsx("span",{className:`text-xs px-2 py-1 rounded-full capitalize ${N.status_hari==="normal"?"bg-green-100 text-green-700":N.status_hari==="libur"?"bg-red-100 text-red-700":"bg-yellow-100 text-yellow-700"}`,children:N.status_hari})]}),N.keterangan&&e.jsx("p",{className:"text-sm text-gray-600 mt-2",children:N.keterangan})]},`${N.tanggal}-${N.kelas.kelas_id}-${L}`))})]},d)),e.jsxs("div",{className:"flex items-center justify-center mt-6 space-x-4",children:[e.jsx("button",{className:"px-3 py-1.5 border rounded-lg text-sm hover:bg-gray-50",disabled:m===1,onClick:()=>i(d=>Math.max(1,d-1)),children:"Sebelumnya"}),e.jsxs("span",{className:"text-sm text-gray-600",children:[m," / ",c]}),e.jsx("button",{className:"px-3 py-1.5 border rounded-lg text-sm hover:bg-gray-50",disabled:m>=c,onClick:()=>i(d=>Math.min(c,d+1)),children:"Selanjutnya"})]}),R&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-md p-6 animate-fadeIn",children:[e.jsx("h3",{className:"text-xl font-bold mb-4 text-gray-800",children:"Edit Status Hari"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Tanggal"}),e.jsx("div",{className:"w-full border border-gray-200 rounded-lg px-3 py-2 bg-gray-50",children:b(R)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Status Hari"}),e.jsxs("select",{value:F,onChange:d=>K(d.target.value),className:"w-full border border-gray-300 rounded-lg px-3 py-2",children:[e.jsx("option",{value:"normal",children:"Normal"}),e.jsx("option",{value:"libur",children:"Libur"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Keterangan (opsional)"}),e.jsx("input",{type:"text",value:w,onChange:d=>v(d.target.value),placeholder:"Keterangan (opsional)",className:"w-full border border-gray-300 rounded-lg px-3 py-2"})]}),e.jsxs("div",{className:"flex justify-end gap-2 pt-3",children:[e.jsx("button",{className:"px-4 py-2 border rounded-lg hover:bg-gray-100 transition",onClick:()=>E(null),children:"Batal"}),e.jsx("button",{className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition",onClick:async()=>{try{const d=await ie.updateRencanaStatusHari({tanggal:R,status_hari:F,keterangan:w});d.data?.responseStatus?(s&&await s(),E(null)):alert(d.data?.responseMessage||"Gagal memperbarui status hari")}catch{alert("Terjadi kesalahan saat memperbarui status hari")}},children:"Simpan"})]})]})]})})]})},Ka=()=>{const a=me(),s=he(),t=[{id:"riwayat",label:"Riwayat",path:"/siswa/riwayat",icon:l=>e.jsx("svg",{className:`w-6 h-6 ${l?"text-blue-600":"text-gray-500"}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v10a2 2 0 002 2h8a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01"})})},{id:"home",label:"Home",path:"/siswa/home",icon:l=>e.jsx("svg",{className:`w-6 h-6 ${l?"text-blue-600":"text-gray-500"}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"})})},{id:"profil",label:"Profil",path:"/siswa/profil",icon:l=>e.jsx("svg",{className:`w-6 h-6 ${l?"text-blue-600":"text-gray-500"}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})})}],n=l=>{a(l)};return e.jsx("div",{className:"fixed bottom-6 left-0 right-0 z-50 px-6",children:e.jsx("div",{className:"max-w-md mx-auto bg-white rounded-2xl shadow-2xl border border-gray-200",children:e.jsx("div",{className:"flex justify-around items-center py-3 px-4",children:t.map(l=>{const h=s.pathname===l.path;return e.jsxs("button",{onClick:()=>n(l.path),className:`flex flex-col items-center justify-center py-2 px-4 rounded-xl transition-all duration-200 ${h?"transform scale-105":"hover:bg-gray-50"}`,children:[l.icon(h),e.jsx("span",{className:`text-xs mt-1 font-medium ${h?"text-blue-600":"text-gray-500"}`,children:l.label})]},l.id)})})})})},He=({data:a=[],columns:s=[],searchFields:t=[],defaultSort:n={field:"",direction:"desc"},defaultItemsPerPage:l=10,searchPlaceholder:h="Cari data...",emptyMessage:g="Tidak ada data",className:m=""})=>{const[i,c]=r.useState(1),[f,M]=r.useState(l),[b,P]=r.useState(""),[C,R]=r.useState(n.field),[E,F]=r.useState(n.direction),K=p=>{C===p?F(E==="asc"?"desc":"asc"):(R(p),F("desc")),c(1)},w=p=>C?[...p].sort(($,_)=>{const z=s.find(q=>q.key===C);let H,O;return z?.sortValue?(H=z.sortValue($),O=z.sortValue(_)):(H=z?.accessor?z.accessor($):$[C],O=z?.accessor?z.accessor(_):_[C]),H instanceof Date&&O instanceof Date?E==="asc"?H.getTime()-O.getTime():O.getTime()-H.getTime():(H=String(H||"").toLowerCase(),O=String(O||"").toLowerCase(),E==="asc"?H>O?1:H<O?-1:0:H<O?1:H>O?-1:0)}):p,v=r.useMemo(()=>{const p=a.filter($=>{if(!b)return!0;const _=b.toLowerCase();return t.some(z=>{const H=typeof z=="function"?z($):$[z];return String(H||"").toLowerCase().includes(_)})});return w(p)},[a,b,C,E,t,s]),d=v.length,k=Math.ceil(d/f),N=(i-1)*f,L=N+f,u=v.slice(N,L),j=p=>{M(p),c(1)},S=p=>{P(p),c(1)},y=p=>{p>=1&&p<=k&&c(p)},A=()=>{const p=[];if(k<=5)for(let _=1;_<=k;_++)p.push(_);else{const _=Math.max(1,i-2),z=Math.min(k,_+5-1);_>1&&(p.push(1),_>2&&p.push("..."));for(let H=_;H<=z;H++)p.push(H);z<k&&(z<k-1&&p.push("..."),p.push(k))}return p},D=({field:p})=>s.find(_=>_.key===p)?.sortable?C!==p?e.jsx("svg",{className:"w-4 h-4 ml-1 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16V4m0 0L3 8m4-4l4 4m6 0v12m0 0l4-4m-4 4l-4-4"})}):E==="asc"?e.jsx("svg",{className:"w-4 h-4 ml-1 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 15l7-7 7 7"})}):e.jsx("svg",{className:"w-4 h-4 ml-1 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})}):null,W=()=>{const p=[];return s.forEach($=>{$.sortable&&(p.push({value:`${$.key}-desc`,label:`${$.label} (Z-A)`}),p.push({value:`${$.key}-asc`,label:`${$.label} (A-Z)`}))}),p};return e.jsxs("div",{className:m,children:[e.jsxs("div",{className:"mb-4 flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Tampilkan:"}),e.jsxs("select",{value:f,onChange:p=>j(Number(p.target.value)),className:"border border-gray-300 rounded px-2 py-1 text-sm",children:[e.jsx("option",{value:5,children:"5"}),e.jsx("option",{value:10,children:"10"}),e.jsx("option",{value:25,children:"25"}),e.jsx("option",{value:50,children:"50"})]}),e.jsx("span",{className:"text-sm text-gray-600",children:"data per halaman"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Cari:"}),e.jsx("input",{type:"text",value:b,onChange:p=>S(p.target.value),placeholder:h,className:"border border-gray-300 rounded px-3 py-1 text-sm w-64"}),b&&e.jsx("button",{onClick:()=>S(""),className:"text-gray-400 hover:text-gray-600",title:"Hapus pencarian",children:"âœ•"})]}),W().length>0&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Urutkan:"}),e.jsx("select",{value:`${C}-${E}`,onChange:p=>{const[$,_]=p.target.value.split("-");R($),F(_),c(1)},className:"border border-gray-300 rounded px-2 py-1 text-sm",children:W().map(p=>e.jsx("option",{value:p.value,children:p.label},p.value))})]})]}),e.jsxs("div",{className:"text-sm text-gray-600 flex flex-col gap-1",children:[e.jsx("div",{children:b?e.jsxs(e.Fragment,{children:["Menampilkan ",N+1," - ",Math.min(L,d)," dari ",d," hasil pencarian (total: ",a.length," data)"]}):e.jsxs(e.Fragment,{children:["Menampilkan ",N+1," - ",Math.min(L,d)," dari ",d," data"]})}),C&&e.jsxs("div",{className:"text-xs text-gray-500",children:["Diurutkan: ",s.find(p=>p.key===C)?.label," (",E==="asc"?"A-Z":"Z-A",")"]})]})]}),e.jsx("div",{className:"overflow-x-auto bg-white rounded-lg border border-gray-200",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsx("tr",{children:s.map(p=>e.jsx("th",{className:`px-4 py-2 text-left text-xs font-semibold text-gray-600 ${p.sortable?"cursor-pointer hover:bg-gray-100 select-none":""}`,onClick:p.sortable?()=>K(p.key):void 0,children:e.jsxs("div",{className:"flex items-center",children:[p.label,e.jsx(D,{field:p.key})]})},p.key))})}),e.jsxs("tbody",{className:"divide-y divide-gray-100",children:[u.map((p,$)=>e.jsx("tr",{children:s.map(_=>e.jsx("td",{className:"px-4 py-2",children:_.render?_.render(p,N+$):_.accessor?_.accessor(p):p[_.key]},_.key))},p.id?String(p.id):`row-${N+$}`)),u.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:s.length,className:"px-4 py-6 text-center text-gray-500",children:b?e.jsxs(e.Fragment,{children:['Tidak ada data yang cocok dengan pencarian "',b,'"',e.jsx("br",{}),e.jsx("button",{onClick:()=>S(""),className:"text-blue-600 hover:text-blue-800 underline mt-2",children:"Hapus filter pencarian"})]}):g})})]})]})}),k>1&&e.jsxs("div",{className:"mt-4 flex flex-col sm:flex-row items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>y(i-1),disabled:i===1,className:"px-3 py-1 border border-gray-300 rounded text-sm hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"â† Sebelumnya"}),e.jsx("div",{className:"flex items-center gap-1",children:A().map((p,$)=>e.jsx("button",{onClick:()=>typeof p=="number"?y(p):null,disabled:p==="...",className:`px-3 py-1 text-sm rounded ${p===i?"bg-[#003366] text-white":p==="..."?"cursor-default":"border border-gray-300 hover:bg-gray-50"}`,children:p},$))}),e.jsx("button",{onClick:()=>y(i+1),disabled:i===k,className:"px-3 py-1 border border-gray-300 rounded text-sm hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Selanjutnya â†’"})]}),e.jsxs("div",{className:"text-sm text-gray-600",children:["Halaman ",i," dari ",k]})]})]})};class Fa extends ee.Component{constructor(s){super(s),this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(s){return{hasError:!0}}componentDidCatch(s,t){console.error("Error caught by boundary:",s,t),this.setState({error:s,errorInfo:t||{componentStack:"No component stack available"}})}render(){return this.state.hasError?e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:e.jsxs("div",{className:"max-w-md w-full bg-white rounded-lg shadow-lg p-6",children:[e.jsx("div",{className:"flex items-center justify-center w-12 h-12 mx-auto bg-red-100 rounded-full mb-4",children:e.jsx("svg",{className:"w-6 h-6 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})})}),e.jsx("h2",{className:"text-xl font-semibold text-gray-900 text-center mb-2",children:"Oops! Terjadi Kesalahan"}),e.jsx("p",{className:"text-gray-600 text-center mb-6",children:"Aplikasi mengalami masalah teknis. Tim kami telah diberitahu dan sedang memperbaikinya."}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("button",{onClick:()=>window.location.reload(),className:"w-full bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-4 rounded-md transition-colors",children:"Muat Ulang Halaman"}),e.jsx("button",{onClick:()=>window.location.href="/",className:"w-full bg-gray-100 hover:bg-gray-200 text-gray-700 font-medium py-2 px-4 rounded-md transition-colors",children:"Kembali ke Beranda"})]}),!1]})}):this.props.children}}const G=({className:a="",...s})=>e.jsx("div",{className:`animate-pulse bg-gray-200 rounded ${a}`,...s}),Ee=({count:a=1})=>e.jsx("div",{className:"grid grid-cols-1 gap-6 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4",children:Array.from({length:a}).map((s,t)=>e.jsx("div",{className:"p-6 bg-white border border-gray-200 shadow-sm rounded-xl",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(G,{className:"w-12 h-12 rounded-lg"}),e.jsxs("div",{className:"ml-4 flex-1",children:[e.jsx(G,{className:"h-4 w-24 mb-2"}),e.jsx(G,{className:"h-6 w-16"})]})]})},t))}),fe=({rows:a=5,columns:s=4})=>e.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg shadow-sm overflow-hidden",children:[e.jsx("div",{className:"bg-gray-50 px-6 py-3 border-b border-gray-200",children:e.jsx("div",{className:"flex space-x-4",children:Array.from({length:s}).map((t,n)=>e.jsx(G,{className:"h-4 flex-1"},n))})}),e.jsx("div",{className:"divide-y divide-gray-100",children:Array.from({length:a}).map((t,n)=>e.jsx("div",{className:"px-6 py-4",children:e.jsx("div",{className:"flex space-x-4",children:Array.from({length:s}).map((l,h)=>e.jsx(G,{className:"h-4 flex-1"},h))})},n))})]}),Wa=()=>e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{children:[e.jsx(G,{className:"h-8 w-64 mb-2"}),e.jsx(G,{className:"h-4 w-48"})]}),e.jsx(Ee,{count:4}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"p-6 bg-white border border-gray-200 shadow-sm rounded-xl",children:[e.jsx(G,{className:"h-6 w-48 mb-4"}),e.jsx(G,{className:"h-64 w-full"})]}),e.jsxs("div",{className:"p-6 bg-white border border-gray-200 shadow-sm rounded-xl",children:[e.jsx(G,{className:"h-6 w-48 mb-4"}),e.jsx(G,{className:"h-64 w-full"})]})]})]}),Oa=({fields:a=4})=>e.jsxs("div",{className:"bg-white border border-gray-200 shadow-sm rounded-xl p-6",children:[e.jsx(G,{className:"h-6 w-48 mb-6"}),e.jsx("div",{className:"space-y-4",children:Array.from({length:a}).map((s,t)=>e.jsxs("div",{children:[e.jsx(G,{className:"h-4 w-24 mb-2"}),e.jsx(G,{className:"h-10 w-full"})]},t))}),e.jsxs("div",{className:"flex justify-end space-x-3 mt-6",children:[e.jsx(G,{className:"h-10 w-20"}),e.jsx(G,{className:"h-10 w-20"})]})]}),Ge=({items:a=5})=>e.jsxs("div",{className:"bg-white border border-gray-200 shadow-sm rounded-xl",children:[e.jsx("div",{className:"p-4 border-b border-gray-200",children:e.jsx(G,{className:"h-6 w-32"})}),e.jsx("div",{className:"divide-y divide-gray-100",children:Array.from({length:a}).map((s,t)=>e.jsxs("div",{className:"p-4 flex items-center space-x-4",children:[e.jsx(G,{className:"w-10 h-10 rounded-full"}),e.jsxs("div",{className:"flex-1",children:[e.jsx(G,{className:"h-4 w-32 mb-2"}),e.jsx(G,{className:"h-3 w-48"})]}),e.jsx(G,{className:"h-8 w-16"})]},t))})]}),Ua=()=>e.jsxs("div",{className:"bg-white border border-gray-200 shadow-sm rounded-xl p-6",children:[e.jsxs("div",{className:"flex items-center space-x-6 mb-6",children:[e.jsx(G,{className:"w-20 h-20 rounded-full"}),e.jsxs("div",{className:"flex-1",children:[e.jsx(G,{className:"h-6 w-48 mb-2"}),e.jsx(G,{className:"h-4 w-32"})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:Array.from({length:6}).map((a,s)=>e.jsxs("div",{children:[e.jsx(G,{className:"h-4 w-24 mb-2"}),e.jsx(G,{className:"h-10 w-full"})]},s))})]}),Re=r.memo(({title:a,value:s,icon:t,color:n="blue",onClick:l,loading:h=!1})=>{const g=r.useMemo(()=>{const i={blue:"bg-blue-100 text-blue-600",green:"bg-green-100 text-green-600",yellow:"bg-yellow-100 text-yellow-600",red:"bg-red-100 text-red-600",purple:"bg-purple-100 text-purple-600",gray:"bg-gray-100 text-gray-600"};return`p-3 rounded-lg ${i[n]||i.blue}`},[n]),m=r.useCallback(()=>{l&&!h&&l()},[l,h]);return h?e.jsx("div",{className:"p-6 bg-white border border-gray-200 shadow-sm rounded-xl",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"animate-pulse bg-gray-200 w-12 h-12 rounded-lg"}),e.jsxs("div",{className:"ml-4 flex-1",children:[e.jsx("div",{className:"animate-pulse bg-gray-200 h-4 w-24 mb-2 rounded"}),e.jsx("div",{className:"animate-pulse bg-gray-200 h-6 w-16 rounded"})]})]})}):e.jsx("div",{className:`p-6 bg-white border border-gray-200 shadow-sm rounded-xl ${l?"cursor-pointer hover:shadow-md transition-shadow":""}`,onClick:m,children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:g,children:t}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:a}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:s})]})]})})});Re.displayName="OptimizedCard";const Ke=r.memo(({data:a,columns:s,onEdit:t,onDelete:n,onView:l,actions:h=!0})=>{const g=r.useCallback(()=>{t&&t(a)},[t,a]),m=r.useCallback(()=>{n&&n(a)},[n,a]),i=r.useCallback(()=>{l&&l(a)},[l,a]),c=r.useMemo(()=>s.map(f=>typeof f.accessor=="function"?f.accessor(a):a[f.accessor]||"-"),[a,s]);return e.jsxs("tr",{className:"border-t hover:bg-gray-50 transition-colors",children:[c.map((f,M)=>e.jsx("td",{className:"px-4 py-2 text-sm text-gray-900",children:f},M)),h&&e.jsx("td",{className:"px-4 py-2 text-sm",children:e.jsxs("div",{className:"flex space-x-2",children:[l&&e.jsx("button",{onClick:i,className:"text-blue-600 hover:text-blue-800 text-xs",children:"Lihat"}),t&&e.jsx("button",{onClick:g,className:"text-green-600 hover:text-green-800 text-xs",children:"Edit"}),n&&e.jsx("button",{onClick:m,className:"text-red-600 hover:text-red-800 text-xs",children:"Hapus"})]})})]})});Ke.displayName="OptimizedTableRow";const Fe=r.memo(({value:a,onChange:s,placeholder:t="Cari...",debounceMs:n=300})=>{const[l,h]=ee.useState(a);ee.useEffect(()=>{const m=setTimeout(()=>{s&&l!==a&&s(l)},n);return()=>clearTimeout(m)},[l,s,a,n]);const g=r.useCallback(m=>{h(m.target.value)},[]);return e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",value:l,onChange:g,placeholder:t,className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx("svg",{className:"h-5 w-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})})]})});Fe.displayName="OptimizedSearchInput";const We=r.memo(({options:a,value:s,onChange:t,placeholder:n="Pilih filter..."})=>{const l=r.useCallback(g=>{t&&t(g.target.value)},[t]),h=r.useMemo(()=>a.map(g=>e.jsx("option",{value:g.value,children:g.label},g.value)),[a]);return e.jsxs("select",{value:s,onChange:l,className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:n}),h]})});We.displayName="OptimizedFilter";const Oe=r.memo(({currentPage:a,totalPages:s,onPageChange:t,showInfo:n=!0})=>{const l=r.useMemo(()=>{const m=[],i=[];for(let c=Math.max(2,a-2);c<=Math.min(s-1,a+2);c++)m.push(c);return a-2>2?i.push(1,"..."):i.push(1),i.push(...m),a+2<s-1?i.push("...",s):i.push(s),i},[a,s]),h=r.useCallback(g=>{t&&g!==a&&g>=1&&g<=s&&t(g)},[t,a,s]);return s<=1?null:e.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-white border-t border-gray-200 sm:px-6",children:[n&&e.jsxs("div",{className:"flex-1 flex justify-between sm:hidden",children:[e.jsx("button",{onClick:()=>h(a-1),disabled:a===1,className:"relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50",children:"Previous"}),e.jsx("button",{onClick:()=>h(a+1),disabled:a===s,className:"ml-3 relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50",children:"Next"})]}),e.jsxs("div",{className:"hidden sm:flex-1 sm:flex sm:items-center sm:justify-between",children:[n&&e.jsx("div",{children:e.jsxs("p",{className:"text-sm text-gray-700",children:["Halaman ",e.jsx("span",{className:"font-medium",children:a})," dari"," ",e.jsx("span",{className:"font-medium",children:s})]})}),e.jsx("div",{children:e.jsxs("nav",{className:"relative z-0 inline-flex rounded-md shadow-sm -space-x-px",children:[e.jsx("button",{onClick:()=>h(a-1),disabled:a===1,className:"relative inline-flex items-center px-2 py-2 rounded-l-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 disabled:opacity-50",children:"â†"}),l.map((g,m)=>e.jsx("button",{onClick:()=>typeof g=="number"&&h(g),disabled:g==="...",className:`relative inline-flex items-center px-4 py-2 border text-sm font-medium ${g===a?"z-10 bg-blue-50 border-blue-500 text-blue-600":g==="..."?"border-gray-300 bg-white text-gray-700 cursor-default":"border-gray-300 bg-white text-gray-500 hover:bg-gray-50"}`,children:g},m)),e.jsx("button",{onClick:()=>h(a+1),disabled:a===s,className:"relative inline-flex items-center px-2 py-2 rounded-r-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 disabled:opacity-50",children:"â†’"})]})})]})]})});Oe.displayName="OptimizedPagination";const Ue=a=>a.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),Ve=a=>a.replace(/^([A-Z])|[\s-_]+(\w)/g,(s,t,n)=>n?n.toUpperCase():t.toLowerCase()),oe=a=>{const s=Ve(a);return s.charAt(0).toUpperCase()+s.slice(1)},be=(...a)=>a.filter((s,t,n)=>!!s&&s.trim()!==""&&n.indexOf(s)===t).join(" ").trim(),Je=a=>{for(const s in a)if(s.startsWith("aria-")||s==="role"||s==="title")return!0};var qe={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const Ze=r.forwardRef(({color:a="currentColor",size:s=24,strokeWidth:t=2,absoluteStrokeWidth:n,className:l="",children:h,iconNode:g,...m},i)=>r.createElement("svg",{ref:i,...qe,width:s,height:s,stroke:a,strokeWidth:n?Number(t)*24/Number(s):t,className:be("lucide",l),...!h&&!Je(m)&&{"aria-hidden":"true"},...m},[...g.map(([c,f])=>r.createElement(c,f)),...Array.isArray(h)?h:[h]]));const J=(a,s)=>{const t=r.forwardRef(({className:n,...l},h)=>r.createElement(Ze,{ref:h,iconNode:s,className:be(`lucide-${Ue(oe(a))}`,`lucide-${a}`,n),...l}));return t.displayName=oe(a),t};const Ye=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],Xe=J("circle-check-big",Ye);const Qe=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],de=J("circle-x",Qe);const ea=[["path",{d:"M12 13v8",key:"1l5pq0"}],["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"m8 17 4-4 4 4",key:"1quai1"}]],aa=J("cloud-upload",ea);const sa=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],ce=J("download",sa);const ta=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],Va=J("eye-off",ta);const ra=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],ke=J("eye",ra);const na=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]],ue=J("file-spreadsheet",na);const ia=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],la=J("pen",ia);const oa=[["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["path",{d:"m9 20 3-6 3 6",key:"se2kox"}],["path",{d:"m6 8 6 2 6-2",key:"4o3us4"}],["path",{d:"M12 10v4",key:"1kjpxc"}]],Ja=J("person-standing",oa);const da=[["path",{d:"M14 21v-3a2 2 0 0 0-4 0v3",key:"1rgiei"}],["path",{d:"M18 5v16",key:"1ethyx"}],["path",{d:"m4 6 7.106-3.79a2 2 0 0 1 1.788 0L20 6",key:"zywc2d"}],["path",{d:"m6 11-3.52 2.147a1 1 0 0 0-.48.854V19a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-5a1 1 0 0 0-.48-.853L18 11",key:"1d4ql0"}],["path",{d:"M6 5v16",key:"1sn0nx"}],["circle",{cx:"12",cy:"9",r:"2",key:"1092wv"}]],qa=J("school",da);const ca=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],ua=J("trash-2",ca);const ma=[["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],ha=J("trash",ma);const xa=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],Za=J("user",xa),Y=a=>{const s=t=>String(t).padStart(2,"0");return`${a.getFullYear()}-${s(a.getMonth()+1)}-${s(a.getDate())}`},ye=a=>{const s=new Date(a),t=s.getDay(),n=(t===0?-6:1)-t;return s.setDate(s.getDate()+n),s.setHours(0,0,0,0),s},ga=a=>{const s=ye(a),t=new Date(s);return t.setDate(s.getDate()+6),t.setHours(23,59,59,999),t},pa=a=>new Date(a.getFullYear(),a.getMonth(),1),fa=a=>new Date(a.getFullYear(),a.getMonth()+1,0);function ba(){const[a,s]=r.useState("harian"),[t,n]=r.useState(()=>new Date),[l,h]=r.useState([]),[g,m]=r.useState([]),[i,c]=r.useState(""),[f,M]=r.useState(!1),[b,P]=r.useState(""),C=r.useMemo(()=>{if(a==="harian")return{period:a,tanggal:Y(t)};if(a==="mingguan"){const k=ye(t),N=ga(t);return{period:a,start:Y(k),end:Y(N)}}const v=pa(t),d=fa(t);return{period:"bulanan",start:Y(v),end:Y(d)}},[a,t]),R=async()=>{try{const k=((await ge.listKelas())?.data?.responseData||[]).map(N=>({id:N.kelas_id,label:`${N.tingkat} ${N.jurusan} ${N.paralel||""}`.trim()}));m(k)}catch{m([])}},E=async()=>{M(!0),P("");try{const v=d=>{const k=new Map;return d.flat().forEach(N=>{const L=N.kelas||N.kelas_nama||"-";k.has(L)||k.set(L,{kelas:L,hadir:0,terlambat:0,izin:0,sakit:0,alfa:0});const u=k.get(L);u.hadir+=N.hadir||0,u.terlambat+=N.terlambat||0,u.izin+=N.izin||0,u.sakit+=N.sakit||0,u.alfa+=N.alfa||0}),Array.from(k.values())};if(a==="harian"){const k=(await U.rekap({tanggal:C.tanggal}))?.data?.responseData?.rekap||[];h(Array.isArray(k)?k:[])}else{const d=new Date(C.start),k=new Date(C.end),N=[],L=new Date(d);for(;L<=k;)N.push(Y(L)),L.setDate(L.getDate()+1);const u=await Promise.all(N.map(j=>U.rekap({tanggal:j}).then(S=>S?.data?.responseData?.rekap||[]).catch(()=>[])));h(v(u))}}catch{P("Gagal memuat rekap. Periksa koneksi atau API backend.")}finally{M(!1)}};r.useEffect(()=>{R()},[]),r.useEffect(()=>{E()},[C]);const F=r.useMemo(()=>i?l.filter(v=>(v.kelas_nama||v.kelas||"")===i):l,[l,i]),K=()=>{const v=[["Kelas","Hadir","Terlambat","Izin","Sakit","Alfa"],...F.map(u=>[u.kelas_nama||u.kelas||"-",u.hadir||0,u.terlambat||0,u.izin||0,u.sakit||0,u.alfa||0])],d=re.aoa_to_sheet(v),k=re.book_new();re.book_append_sheet(k,d,"Rekap");const N=C.tanggal||`${C.start}_${C.end}`,L=i?`_${i.replace(/\s+/g,"-")}`:"";Ce(k,`rekap_${a}_${N}${L}.xlsx`)},w=()=>{window.print()};return f&&l.length===0?e.jsxs("div",{className:"px-4 py-8 max-w-7xl mx-auto sm:px-6 lg:px-8",children:[e.jsx("div",{className:"mb-8",children:e.jsxs("div",{className:"animate-pulse",children:[e.jsx("div",{className:"h-8 bg-gray-200 rounded w-64 mb-2"}),e.jsx("div",{className:"h-4 bg-gray-200 rounded w-48"})]})}),e.jsx(fe,{rows:8,columns:7})]}):e.jsx("div",{className:"min-h-screen bg-gray-50",children:e.jsxs("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6 border border-gray-200 mb-6",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>s("harian"),className:`px-3 py-1.5 rounded-md text-sm ${a==="harian"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700"}`,children:"Harian"}),e.jsx("button",{onClick:()=>s("mingguan"),className:`px-3 py-1.5 rounded-md text-sm ${a==="mingguan"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700"}`,children:"Mingguan"}),e.jsx("button",{onClick:()=>s("bulanan"),className:`px-3 py-1.5 rounded-md text-sm ${a==="bulanan"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700"}`,children:"Bulanan"})]}),e.jsx("input",{type:"date",value:Y(t),onChange:v=>n(new Date(v.target.value)),className:"px-3 py-1.5 border border-gray-300 rounded-md text-sm"}),e.jsxs("select",{value:i,onChange:v=>c(v.target.value),className:"px-3 py-1.5 border border-gray-300 rounded-md text-sm",children:[e.jsx("option",{value:"",children:"Semua Kelas"}),g.map(v=>e.jsx("option",{value:v.label,children:v.label},v.id))]}),e.jsxs("div",{className:"ml-auto flex gap-2",children:[e.jsx("button",{onClick:K,className:"bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg text-sm font-medium",children:"Export Excel"}),e.jsx("button",{onClick:w,className:"bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded-lg text-sm font-medium",children:"Export PDF"})]})]}),a!=="harian"&&e.jsxs("p",{className:"mt-2 text-xs text-gray-500",children:["Rentang: ",C.start," â€” ",C.end]})]}),e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden rekap-print-area",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table-base",children:[e.jsx("thead",{className:"table-thead",children:e.jsxs("tr",{children:[e.jsx("th",{className:"table-th",children:"Kelas"}),e.jsx("th",{className:"table-th",children:"Hadir"}),e.jsx("th",{className:"table-th",children:"Terlambat"}),e.jsx("th",{className:"table-th",children:"Izin"}),e.jsx("th",{className:"table-th",children:"Sakit"}),e.jsx("th",{className:"table-th",children:"Alfa"})]})}),e.jsx("tbody",{className:"table-tbody",children:F.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"table-empty",children:"Tidak ada data rekap."})}):F.map((v,d)=>e.jsxs("tr",{className:"table-tr hover:bg-gray-50",children:[e.jsx("td",{className:"table-td",children:v.kelas_nama||v.kelas||"-"}),e.jsx("td",{className:"table-td",children:v.hadir||0}),e.jsx("td",{className:"table-td",children:v.terlambat||0}),e.jsx("td",{className:"table-td",children:v.izin||0}),e.jsx("td",{className:"table-td",children:v.sakit||0}),e.jsx("td",{className:"table-td",children:v.alfa||0})]},d))})]})})})]})})}const Ya=Object.freeze(Object.defineProperty({__proto__:null,default:ba},Symbol.toStringTag,{value:"Module"})),ka=({formData:a,handleChange:s,handleSave:t,handleCancel:n,kelasList:l=[]})=>{const[h,g]=r.useState(!1);return e.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-black/40 backdrop-blur-sm z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-2xl p-8 animate-fade-in",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-6 text-center",children:"Edit Data Siswa"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-5",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-sm font-semibold text-gray-700 mb-1",children:"NIS"}),e.jsx("input",{name:"nis",value:a.nis||"",onChange:s,className:"w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none"})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-sm font-semibold text-gray-700 mb-1",children:"Nama"}),e.jsx("input",{name:"nama",value:a.nama||"",onChange:s,className:"w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none"})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-sm font-semibold text-gray-700 mb-1",children:"Jenis Kelamin"}),e.jsxs("select",{name:"jenkel",value:a.jenkel||"",onChange:s,className:"w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none",children:[e.jsx("option",{value:"",children:"Pilih Jenis Kelamin"}),e.jsx("option",{value:"L",children:"Laki-laki"}),e.jsx("option",{value:"P",children:"Perempuan"})]})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-sm font-semibold text-gray-700 mb-1",children:"Kelas"}),e.jsxs("select",{name:"kelas_id",value:a.kelas_id||"",onChange:s,className:"w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none",children:[e.jsx("option",{value:"",children:"Pilih Kelas"}),l.map(m=>e.jsx("option",{value:m.id,children:m.label},m.id))]})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-sm font-semibold text-gray-700 mb-1",children:"Status"}),e.jsxs("select",{name:"status",value:a.status||"aktif",onChange:s,className:"w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none",children:[e.jsx("option",{value:"aktif",children:"Aktif"}),e.jsx("option",{value:"naik kelas",children:"Naik Kelas"}),e.jsx("option",{value:"tidak naik kelas",children:"Tidak Naik Kelas"})]})]}),e.jsxs("div",{className:"md:col-span-2 flex flex-col",children:[e.jsx("label",{className:"text-sm font-semibold text-gray-700 mb-1",children:"Password Baru"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{name:"password",type:h?"text":"password",value:a.password||"",onChange:s,placeholder:"Kosongkan jika tidak ingin mengubah",className:"w-full border border-gray-300 rounded-lg px-4 py-2 pr-10 focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none"}),e.jsx("button",{type:"button",onClick:()=>g(!h),className:"absolute inset-y-0 right-0 px-3 flex items-center text-gray-500 hover:text-gray-700",children:h?"ğŸ™ˆ":"ğŸ‘ï¸"})]})]})]}),e.jsxs("div",{className:"mt-8 flex justify-end gap-3",children:[e.jsx("button",{onClick:n,className:"px-5 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition font-medium",children:"Batal"}),e.jsx("button",{onClick:t,className:"px-5 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition font-medium shadow-md",children:"Simpan Perubahan"})]})]})})},ya=()=>{const[a,s]=r.useState([]),[t,n]=r.useState(!0),[l,h]=r.useState(null),[g,m]=r.useState(null),[i,c]=r.useState({}),[f,M]=r.useState([]),[b,P]=r.useState([]),[C,R]=r.useState([]),[E,F]=r.useState(!1),[K,w]=r.useState({nis:"",nama:"",jenkel:"L",kelas_id:""}),[v,d]=r.useState(!1),[k,N]=r.useState([]),[L,u]=r.useState(!1),[j,S]=r.useState(""),[y,A]=r.useState(""),[D,W]=r.useState("");r.useEffect(()=>{(async()=>{try{const T=await U.getDataSiswa();T.status===200&&T.data.responseStatus?s(T.data.responseData):h(T.data.responseMessage||"Gagal memuat data siswa")}catch{h("Terjadi kesalahan saat memuat data siswa")}finally{n(!1)}})()},[]),r.useEffect(()=>{(async()=>{try{const B=(await ge.listKelas())?.data?.responseData??[];console.log("data kelas:",B),P(B);const V=B.map(Z=>({id:Z.kelas_id,label:`${Z.tingkat} ${Z.jurusan?.nama_jurusan??Z.jurusan} ${Z.paralel||""}`}));M(V)}catch{M([])}})()},[]),r.useEffect(()=>{(async()=>{try{const B=(await U.getJurusan())?.data?.responseData?.jurusan??[];R(Array.isArray(B)?B:[])}catch{R([])}})()},[]);const p=o=>{m(o.siswa_id),c({nis:o.nis,nama:o.nama,jenkel:o.jenkel,kelas_id:o.kelas_id||o.kelas?.kelas_id||"",status:o.status||"aktif"})},$=o=>{const{name:T,value:B}=o.target;c(V=>({...V,[T]:B}))},_=async()=>{try{const o={nis:i.nis,nama:i.nama,jenkel:i.jenkel,username:i.nis,status:i.status};if(i.kelas_id)o.kelas_id=Number(i.kelas_id);else{I.fire({icon:"error",title:"Gagal",text:"Kelas wajib dipilih."});return}i.password&&String(i.password).length>0&&(o.password=i.password);const T=await U.updateSiswa(g,o);if(T.status===200&&T.data.responseStatus){const B=await U.getDataSiswa();s(B.data.responseData),m(null),I.fire({icon:"success",title:"Berhasil",text:"Data siswa berhasil diperbarui"})}else I.fire({icon:"error",title:"Gagal",text:T.data.responseMessage||"Gagal memperbarui data"})}catch(o){const T=o?.response?.data?.responseMessage||"Terjadi kesalahan saat menyimpan data";I.fire({icon:"error",title:"Gagal",text:T})}},z=()=>{m(null),c({})},H=async o=>{S(o.nama),d(!0),u(!0),N([]);try{const B=(await U.getRiwayatKelas({siswa_id:o.siswa_id}))?.data?.responseData?.riwayat??[];N(B)}catch(T){console.error(T),I.fire({icon:"error",title:"Gagal",text:"Gagal memuat riwayat kelas"})}finally{u(!1)}},O=async o=>{if((await I.fire({title:"Hapus Siswa",text:`Apakah Anda yakin ingin menghapus siswa ${o.nama} (${o.nis})? Data absensi dan riwayat kelas akan ikut terhapus.`,icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#3085d6",confirmButtonText:"Ya, Hapus!",cancelButtonText:"Batal"})).isConfirmed)try{const B=await U.deleteSiswa(o.siswa_id);if(B.status===200&&B.data.responseStatus){const V=await U.getDataSiswa();s(V.data.responseData),I.fire({icon:"success",title:"Berhasil",text:"Siswa berhasil dihapus"})}else I.fire({icon:"error",title:"Gagal",text:B.data.responseMessage||"Gagal menghapus siswa"})}catch(B){const V=B?.response?.data?.responseMessage||"Terjadi kesalahan saat menghapus siswa";I.fire({icon:"error",title:"Gagal",text:V})}},q=async()=>{if((await I.fire({title:"Hapus Semua Siswa",html:`
        <div class="text-left">
          <p class="mb-2">Apakah Anda yakin ingin menghapus <strong>SEMUA DATA SISWA</strong>?</p>
          <p class="text-red-600 font-semibold mb-2">âš ï¸ PERINGATAN:</p>
          <ul class="text-sm text-gray-700 list-disc list-inside">
            <li>Semua data siswa akan dihapus permanen</li>
            <li>Semua riwayat kelas akan dihapus</li>
            <li>Semua data absensi akan dihapus</li>
            <li>Semua akun login siswa akan dihapus</li>
          </ul>
          <p class="mt-3 text-red-600 font-bold">Tindakan ini TIDAK DAPAT DIBATALKAN!</p>
        </div>
      `,icon:"warning",showCancelButton:!0,confirmButtonColor:"#dc2626",cancelButtonColor:"#6b7280",confirmButtonText:"Ya, Hapus Semua!",cancelButtonText:"Batal",reverseButtons:!0,focusCancel:!0})).isConfirmed&&(await I.fire({title:"Konfirmasi Terakhir",text:'Ketik "HAPUS SEMUA" untuk melanjutkan',input:"text",inputPlaceholder:"Ketik: HAPUS SEMUA",showCancelButton:!0,confirmButtonColor:"#dc2626",cancelButtonColor:"#6b7280",confirmButtonText:"Hapus Semua Data",cancelButtonText:"Batal",inputValidator:B=>{if(B!=="HAPUS SEMUA")return'Anda harus mengetik "HAPUS SEMUA" dengan benar!'}})).isConfirmed)try{const B=await U.deleteAllSiswa();B.status===200&&B.data.responseStatus?(s([]),I.fire({icon:"success",title:"Berhasil",text:"Semua data siswa berhasil dihapus"})):I.fire({icon:"error",title:"Gagal",text:B.data.responseMessage||"Gagal menghapus semua siswa"})}catch(B){const V=B?.response?.data?.responseMessage||"Terjadi kesalahan saat menghapus semua siswa";I.fire({icon:"error",title:"Gagal",text:V})}},ae=r.useMemo(()=>a.filter(o=>{if(y&&(o.jenkel||"").toString()!==y)return!1;if(D){const T=o.kelas_id||o.kelas?.kelas_id;if(!T||String(T)!==String(D))return!1}return!0}),[a,y,D]),ne=()=>{A(""),W("")},je=async()=>{const o=String(K.nis||"").trim(),T=String(K.nama||"").trim(),B=String(K.kelas_id||"").trim();if(!o){I.fire({icon:"error",title:"Gagal",text:"NIS wajib diisi"});return}if(!/^\d+$/.test(o)){I.fire({icon:"error",title:"Gagal",text:"NIS hanya boleh mengandung angka"});return}if(!T){I.fire({icon:"error",title:"Gagal",text:"Nama wajib diisi"});return}if(!/^[a-zA-Z\s]+$/.test(T)){I.fire({icon:"error",title:"Gagal",text:"Nama tidak boleh mengandung angka dan simbol"});return}if(!B){I.fire({icon:"error",title:"Gagal",text:"Kelas wajib dipilih"});return}const V=Number(B);if(Number.isNaN(V)){I.fire({icon:"error",title:"Gagal",text:"Kelas tidak valid"});return}try{const Z={...K,nis:o,nama:T,kelas_id:V},X=await U.createSiswa(Z);if(X.status===200&&X.data.responseStatus){const Ne=await U.getDataSiswa();s(Ne.data.responseData),F(!1),w({nis:"",nama:"",jenkel:"L",kelas_id:""});const Se=X?.data?.responseData?.password||"TRI12345";I.fire({icon:"success",title:"Siswa Berhasil Ditambahkan",html:`
            <div class="text-left">
              <p class="mb-3 text-green-600 font-semibold">âœ… Siswa berhasil ditambahkan!</p>
              
              <div class="bg-blue-50 border border-blue-200 rounded-lg p-4 mb-4">
                <h4 class="font-semibold text-blue-800 mb-2">ğŸ“‹ Informasi Login:</h4>
                <div class="space-y-2 text-sm">
                  <div class="flex justify-between">
                    <span class="text-gray-600">Username:</span>
                    <span class="font-mono bg-gray-100 px-2 py-1 rounded">${o}</span>
                  </div>
                  <div class="flex justify-between">
                    <span class="text-gray-600">Password:</span>
                    <span class="font-mono bg-gray-100 px-2 py-1 rounded">${Se}</span>
                  </div>
                </div>
              </div>
              
              <div class="bg-orange-50 border border-orange-200 rounded-lg p-4">
                <h4 class="font-semibold text-orange-800 mb-2">âš ï¸ Penting:</h4>
                <p class="text-sm text-orange-700">
                  Harap segera minta siswa untuk <strong>mengganti password default</strong> 
                  setelah login pertama kali untuk keamanan akun.
                </p>
              </div>
            </div>
          `,confirmButtonText:"OK, Mengerti",confirmButtonColor:"#003366",width:500,allowOutsideClick:!1,allowEscapeKey:!1})}else I.fire({icon:"error",title:"Gagal",text:X.data.responseMessage||"Gagal menambah siswa"})}catch(Z){const X=Z?.response?.data?.responseMessage||"Terjadi kesalahan saat menambah siswa";I.fire({icon:"error",title:"Gagal",text:X})}};if(t)return e.jsxs("div",{className:"px-4 py-8 max-w-7xl mx-auto sm:px-6 lg:px-8",children:[e.jsx("div",{className:"mb-8",children:e.jsxs("div",{className:"animate-pulse",children:[e.jsx("div",{className:"h-8 bg-gray-200 rounded w-64 mb-2"}),e.jsx("div",{className:"h-4 bg-gray-200 rounded w-48"})]})}),e.jsx(fe,{rows:10,columns:6})]});if(l)return e.jsx("div",{className:"p-4 text-red-600",children:l});const we=[{key:"no",label:"No",render:(o,T)=>T+1},{key:"nis",label:"NIS",sortable:!0,accessor:o=>o.nis||"-"},{key:"nama",label:"Nama",sortable:!0,accessor:o=>o.nama||"-"},{key:"jenkel",label:"Jenis Kelamin",sortable:!0,accessor:o=>o.jenkel==="L"?"Laki-laki":o.jenkel==="P"?"Perempuan":o.jenkel||"-"},{key:"tingkat",label:"Tingkat",sortable:!0,accessor:o=>o.kelas?.tingkat||"-"},{key:"jurusan",label:"Jurusan",sortable:!0,accessor:o=>o.kelas?.jurusan?.nama_jurusan||"-"},{key:"paralel",label:"Paralel",sortable:!0,accessor:o=>o.kelas?.paralel||"-"},{key:"status",label:"Status",sortable:!0,accessor:o=>o.status||"-"},{key:"actions",label:"Aksi",render:o=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>p(o),className:"p-2 text-blue-600 hover:text-blue-800 hover:bg-blue-50 rounded-lg transition-colors",title:"Edit",children:e.jsx(la,{size:16})}),e.jsx("button",{onClick:()=>H(o),className:"p-2 text-green-600 hover:text-green-800 hover:bg-green-50 rounded-lg transition-colors",title:"Lihat Riwayat",children:e.jsx(ke,{size:16})}),e.jsx("button",{onClick:()=>O(o),className:"p-2 text-red-600 hover:text-red-800 hover:bg-red-50 rounded-lg transition-colors",title:"Hapus",children:e.jsx(ua,{size:16})})]})}],ve=["nis","nama",o=>o.kelas?.jurusan?.nama_jurusan||"",o=>o.kelas?.tingkat?String(o.kelas.tingkat):"",o=>o.kelas?.paralel||""];return e.jsxs("div",{className:"flex flex-col p-6 md:p-8",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Kelola Data Siswa"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:q,disabled:a.length===0,className:"px-4 py-2 text-sm font-medium text-white bg-red-600 rounded-lg hover:bg-red-700 disabled:bg-gray-400 disabled:cursor-not-allowed flex items-center gap-2",children:[e.jsx(ha,{size:16}),"Hapus Semua"]}),e.jsx("button",{onClick:()=>F(o=>!o),className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-lg hover:bg-blue-700",children:E?"Tutup":"Tambah Siswa"})]})]}),l&&e.jsx("div",{className:"mb-3 text-red-600 font-semibold",children:l}),E&&e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[e.jsx("div",{className:"absolute inset-0 bg-black/40",onClick:()=>F(!1)}),e.jsxs("div",{className:"relative z-10 w-full max-w-lg bg-white rounded-xl shadow-lg p-6",children:[e.jsx("div",{className:"flex items-center justify-between mb-4",children:e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Tambah Siswa"})}),e.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[e.jsx("input",{type:"text",value:K.nis,onChange:o=>w(T=>({...T,nis:o.target.value})),placeholder:"NIS",className:"w-full border border-gray-300 rounded-lg px-3 py-2"}),e.jsx("input",{type:"text",value:K.nama,onChange:o=>w(T=>({...T,nama:o.target.value})),placeholder:"Nama",className:"w-full border border-gray-300 rounded-lg px-3 py-2"}),e.jsxs("select",{value:K.jenkel,onChange:o=>w(T=>({...T,jenkel:o.target.value})),className:"w-full border border-gray-300 rounded-lg px-3 py-2",children:[e.jsx("option",{value:"L",children:"Laki-laki"}),e.jsx("option",{value:"P",children:"Perempuan"})]}),e.jsxs("select",{value:K.kelas_id,onChange:o=>w(T=>({...T,kelas_id:o.target.value})),className:"w-full border border-gray-300 rounded-lg px-3 py-2",children:[e.jsx("option",{value:"",children:"Pilih Kelas"}),f.map(o=>e.jsx("option",{value:o.id,children:o.label},o.id))]}),e.jsxs("div",{className:"flex items-center justify-end gap-2 mt-2",children:[e.jsx("button",{onClick:()=>F(!1),className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200",children:"Batal"}),e.jsx("button",{onClick:je,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-lg hover:opacity-85",children:"Simpan"})]})]})]})]}),g&&e.jsx(ka,{formData:i,handleChange:$,handleSave:_,handleCancel:z,kelasList:f}),v&&e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[e.jsx("div",{className:"absolute inset-0 bg-black/40",onClick:()=>d(!1)}),e.jsxs("div",{className:"relative z-10 w-full max-w-2xl bg-white rounded-xl shadow-lg p-6 max-h-[80vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:["Riwayat Kelas: ",j]}),e.jsx("button",{onClick:()=>d(!1),className:"text-gray-500 hover:text-gray-700 text-xl",children:"Ã—"})]}),L?e.jsx(Ge,{items:5}):k.length===0?e.jsx("div",{className:"text-center py-8 text-gray-500",children:"Tidak ada riwayat kelas tercatat."}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm text-left",children:[e.jsx("thead",{className:"bg-gray-50 text-gray-700 font-medium border-b border-gray-200",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3",children:"No"}),e.jsx("th",{className:"px-4 py-3",children:"Kelas"}),e.jsx("th",{className:"px-4 py-3",children:"Status"}),e.jsx("th",{className:"px-4 py-3",children:"Tanggal Pencatatan"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-100",children:k.map((o,T)=>{const B=o.kelas?`${o.kelas.tingkat} ${o.kelas.jurusan?.nama_jurusan||""} ${o.kelas.paralel||""}`:"-",V=o.created_at?new Date(o.created_at).toLocaleDateString("id-ID",{day:"numeric",month:"long",year:"numeric"}):"-";return e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-4 py-3",children:T+1}),e.jsx("td",{className:"px-4 py-3 font-medium text-gray-800",children:B}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${o.status==="aktif"?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`,children:o.status})}),e.jsx("td",{className:"px-4 py-3 text-gray-600",children:V})]},o.riwayat_kelas_id)})})]})}),e.jsx("div",{className:"flex justify-end mt-4",children:e.jsx("button",{onClick:()=>d(!1),className:"px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200",children:"Tutup"})})]})]}),e.jsxs("div",{className:"mb-4 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3",children:[e.jsx("div",{children:e.jsxs("select",{value:y,onChange:o=>A(o.target.value),className:"w-full border border-gray-300 rounded-lg px-3 py-2",children:[e.jsx("option",{value:"",children:"Semua Jenkel"}),e.jsx("option",{value:"L",children:"Laki-laki"}),e.jsx("option",{value:"P",children:"Perempuan"})]})}),e.jsx("div",{children:e.jsxs("select",{value:D,onChange:o=>W(o.target.value),className:"w-full border border-gray-300 rounded-lg px-3 py-2",children:[e.jsx("option",{value:"",children:"Semua Kelas"}),f.map(o=>e.jsx("option",{value:o.id,children:o.label},o.id))]})}),e.jsx("div",{children:e.jsx("button",{onClick:ne,className:"w-full px-3 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Reset Filter"})})]}),e.jsx(He,{data:ae,columns:we,searchFields:ve,searchPlaceholder:"Cari nama atau NIS siswa...",emptyMessage:"Tidak ada data siswa",defaultSort:{field:"nama",direction:"asc"},defaultItemsPerPage:20})]})},Xa=Object.freeze(Object.defineProperty({__proto__:null,default:ya},Symbol.toStringTag,{value:"Module"})),ja=()=>{const[a,s]=r.useState(null),[t,n]=r.useState(!1),[l,h]=r.useState(0),[g,m]=r.useState(""),[i,c]=r.useState(!1),[f,M]=r.useState(!1),[b,P]=r.useState(null),[C,R]=r.useState(!1),E=[{id:"excel",name:"Template Excel (.xls)",description:"",icon:ue,color:"text-green-600",bgColor:"bg-green-50",borderColor:"border-green-200",previewImage:"/images/preview.png",downloadUrl:"/templates/template-siswa.xls",format:".xls"}],F=u=>{P(u),M(!0)},K=async u=>{try{const j=document.createElement("a");j.href=u.downloadUrl,j.download=`template-siswa${u.format}`,j.target="_blank",document.body.appendChild(j),j.click(),document.body.removeChild(j)}catch(j){console.error("Error downloading template:",j),I.fire({icon:"error",title:"Gagal mendownload template",text:"Terjadi kesalahan saat mendownload template. Silakan coba lagi."})}},w=u=>{s(u.target.files[0]),m(""),c(!1)},v=u=>{u.preventDefault(),R(!1);const j=u.dataTransfer.files&&u.dataTransfer.files[0];if(!j)return;const y=(j.name||"").split(".").pop().toLowerCase();if(!["xls","xlsx"].includes(y)){m("Format file tidak didukung. Gunakan .xls atau .xlsx"),c(!1);return}s(j),m(""),c(!1)},d=u=>{u.preventDefault(),C||R(!0)},k=u=>{u.preventDefault(),C&&R(!1)},N=u=>new Promise(j=>{const S=new FileReader;S.onload=y=>{try{const A=new Uint8Array(y.target.result),D=Me(A,{type:"array"}),W=D.SheetNames[0],p=D.Sheets[W],$=re.sheet_to_json(p,{header:1,defval:""}),_=14;let z=!1,H=0;for(let O=_;O<$.length;O++){const q=$[O];if(!q||q.length===0)continue;const ae=String(q[1]??"").trim(),ne=String(q[2]??"").trim();!ae&&!ne||(z=!0,ae||H++)}if(!z){I.fire({icon:"warning",title:"Data kosong",text:"File tidak berisi data siswa dengan NIS dan Nama. Mohon isi data terlebih dahulu."}).then(()=>{j(!1)});return}if(H>0){I.fire({icon:"warning",title:"NIS belum lengkap",text:`Terdapat ${H} baris dengan NIS kosong. Mohon lengkapi NIS sebelum import.`}).then(()=>{j(!1)});return}j(!0)}catch(A){console.error("Gagal membaca file import siswa:",A),I.fire({icon:"error",title:"Gagal membaca file",text:"Gagal membaca file. Pastikan format mengikuti template yang disediakan."}).then(()=>{j(!1)})}},S.onerror=()=>{I.fire({icon:"error",title:"Gagal membaca file",text:"Gagal membaca file. Silakan pilih file lain atau coba lagi."}).then(()=>{j(!1)})},S.readAsArrayBuffer(u)}),L=async u=>{if(u.preventDefault(),!a){m("Silakan pilih file terlebih dahulu.");return}if(!await N(a))return;const S=new FormData;S.append("file",a);try{n(!0),h(0),m(""),c(!1);const y=await U.importSiswa(S,A=>{const D=Math.round(A.loaded*100/A.total);h(D)});if(y.status===200){const A=y.data?.responseData;m("Data siswa berhasil diimpor!"),c(!0);const D=A?.nis_duplikat;if(Array.isArray(D)&&D.length>0){const W=D.join(", ");I.fire({icon:"warning",title:"Sebagian NIS sudah terdaftar",text:`NIS berikut sudah ada di database dan tidak diimport ulang: ${W}`})}}else m("Gagal mengimpor data siswa."),c(!1)}catch(y){console.error(y),m("Gagal mengunggah file."),c(!1)}finally{n(!1),setTimeout(()=>h(0),2e3)}};return e.jsxs("div",{className:"p-8",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-[#003366] mb-2",children:"Import Data Siswa"}),e.jsx("p",{className:"text-gray-500",children:"Upload file Excel (.xlsx / .xls) sesuai dengan template yang disediakan"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Template File"}),e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Pilih dan download template sesuai format yang Anda inginkan. Pastikan data mengikuti format yang benar."})]}),e.jsx("div",{className:"space-y-4",children:E.map(u=>{const j=u.icon;return e.jsxs("div",{className:`p-4 rounded-xl border-2 ${u.borderColor} ${u.bgColor} hover:shadow-md transition-all duration-200`,children:[e.jsx("div",{className:"flex items-start justify-between",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-white",children:e.jsx(j,{className:`w-6 h-6 ${u.color}`})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:u.name}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:u.description}),e.jsx("div",{className:"mt-2",children:e.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-gray-100 text-gray-800",children:["Format: ",u.format]})})]})]})}),e.jsxs("div",{className:"flex space-x-2 mt-4",children:[e.jsxs("button",{onClick:()=>F(u),className:"flex items-center px-3 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:[e.jsx(ke,{className:"w-4 h-4 mr-2"}),"Preview"]}),e.jsxs("button",{onClick:()=>K(u),className:"flex items-center px-3 py-2 text-sm font-medium text-white bg-green-600 hover:bg-green-700 rounded-lg transition-colors",children:[e.jsx(ce,{className:"w-4 h-4 mr-2"}),"Download"]})]})]},u.id)})})]}),e.jsx("div",{className:"flex justify-center",children:e.jsxs("div",{className:"w-full max-w-md p-8 bg-white border border-gray-200 shadow-lg rounded-2xl",children:[e.jsxs("div",{className:"flex flex-col items-center mb-6",children:[e.jsx("div",{className:"p-4 bg-[#003366]/10 rounded-full",children:e.jsx(aa,{className:"w-10 h-10 text-[#003366]"})}),e.jsx("h2",{className:"mt-4 text-2xl font-bold text-center text-gray-900",children:"Upload File"}),e.jsx("p",{className:"mt-1 text-sm text-center text-gray-500",children:"Pilih file yang sudah sesuai template"})]}),e.jsxs("form",{onSubmit:L,className:"space-y-5",children:[e.jsxs("div",{className:`flex flex-col items-center justify-center border-2 border-dashed rounded-xl p-6 cursor-pointer transition ${C?"border-[#003366] bg-[#003366]/5":"border-gray-300 hover:border-[#003366]"}`,onDrop:v,onDragOver:d,onDragLeave:k,children:[e.jsx("input",{id:"file",type:"file",accept:".xlsx, .xls",onChange:w,className:"hidden"}),e.jsx("label",{htmlFor:"file",className:"text-center text-gray-600 cursor-pointer",children:a?e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"font-semibold text-[#003366]",children:a.name}),e.jsx("p",{className:"text-xs text-gray-500",children:"Klik untuk ganti file"})]}):e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"font-semibold text-gray-600",children:"Klik untuk memilih file"}),e.jsx("p",{className:"mt-1 text-xs text-gray-400",children:"atau drag & drop ke sini"})]})})]}),t&&e.jsx("div",{className:"w-full h-2 overflow-hidden bg-gray-200 rounded-full",children:e.jsx("div",{className:"bg-[#003366] h-2 transition-all duration-700 ease-in-out",style:{width:`${l}%`}})}),e.jsx("button",{type:"submit",disabled:t,className:`w-full py-2 font-medium text-white rounded-lg transition duration-200 shadow-md ${t?"bg-gray-400 cursor-not-allowed":"bg-[#003366] hover:bg-[#002244]"}`,children:t?"Mengunggah...":"Import Sekarang"})]}),g&&e.jsxs("div",{className:`mt-6 flex items-center justify-center gap-2 text-sm font-medium text-center p-3 rounded-lg ${i?"bg-green-50 text-green-700 border border-green-200":"bg-red-50 text-red-700 border border-red-200"}`,children:[i?e.jsx(Xe,{className:"w-5 h-5"}):e.jsx(de,{className:"w-5 h-5"}),g]})]})})]}),f&&b&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-4xl w-full mx-4 max-h-[90vh] overflow-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-xl font-semibold text-gray-900",children:["Preview: ",b.name]}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:b.description})]}),e.jsx("button",{onClick:()=>M(!1),className:"p-2 text-gray-400 hover:text-gray-600 rounded-lg hover:bg-gray-100 transition-colors",children:e.jsx(de,{className:"w-6 h-6"})})]}),e.jsxs("div",{className:"p-6 overflow-y-auto max-h-[calc(90vh-140px)]",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-3",children:"Preview Template:"}),e.jsx("div",{className:"border border-gray-200 rounded-lg overflow-hidden bg-gray-50",children:e.jsxs("div",{className:"flex items-center justify-center p-4",children:[e.jsx("img",{src:b.previewImage,alt:`Preview ${b.name}`,className:"max-w-full h-auto rounded shadow-sm",onError:u=>{u.target.style.display="none",u.target.nextSibling.style.display="block"}}),e.jsxs("div",{className:"hidden text-center p-8 text-gray-500",children:[e.jsx(ue,{className:"w-16 h-16 mx-auto mb-4 text-gray-400"}),e.jsx("p",{children:"Preview gambar tidak tersedia"}),e.jsx("p",{className:"text-sm mt-2",children:"Silakan download template untuk melihat format yang benar"})]})]})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:"Petunjuk Penggunaan:"}),e.jsxs("ol",{className:"list-decimal list-inside space-y-1 text-sm text-gray-600",children:[e.jsx("li",{children:'Download template dengan klik tombol "Download"'}),e.jsx("li",{children:"Buka file template dengan aplikasi spreadsheet (Excel, LibreOffice, dll)"}),e.jsx("li",{children:"Isi data siswa sesuai dengan kolom yang tersedia"}),e.jsx("li",{children:"Pastikan format data sesuai dengan ketentuan"}),e.jsx("li",{children:"Simpan file dan upload melalui form di sebelah kanan"})]})]}),e.jsxs("div",{className:"p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[e.jsx("h5",{className:"font-semibold text-blue-800 mb-2",children:"Catatan Penting:"}),e.jsxs("ul",{className:"text-sm text-blue-700 space-y-1",children:[e.jsx("li",{children:"â€¢ Jangan mengubah nama kolom header"}),e.jsx("li",{children:"â€¢ Pastikan tidak ada baris kosong di tengah data"}),e.jsx("li",{children:"â€¢ NIS harus unik (tidak boleh sama)"}),e.jsx("li",{children:"â€¢ Kelas harus sudah terdaftar di sistem"})]})]})]})]}),e.jsxs("div",{className:"flex items-center justify-end space-x-3 p-6 border-t border-gray-200 bg-gray-50",children:[e.jsx("button",{onClick:()=>M(!1),className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:"Tutup"}),e.jsxs("button",{onClick:()=>{K(b),M(!1)},className:"flex items-center px-4 py-2 text-sm font-medium text-white bg-[#003366] rounded-lg hover:bg-[#002244] transition-colors",children:[e.jsx(ce,{className:"w-4 h-4 mr-2"}),"Download Template"]})]})]})})]})},Qa=Object.freeze(Object.defineProperty({__proto__:null,default:ja},Symbol.toStringTag,{value:"Module"}));function wa(){const[a,s]=r.useState({latitude:-6.229728,longitude:106.689431,radius_meter:50,jam_masuk:"07:00",jam_pulang:"15:30",toleransi_telat:10}),[t,n]=r.useState(!1),[l,h]=r.useState(!1),[g,m]=r.useState(null),i=r.useRef(null),c=r.useRef(null),f=r.useRef(null),M=r.useRef(0),[b,P]=r.useState(0),[C,R]=r.useState(!0),E=r.useRef({started:0,loaded:0}),F=async(L=!1)=>{n(!0);try{const u=await U.getSettings(),j=u?.data?.responseData||u?.data||{};s(S=>({...S,latitude:j.latitude??S.latitude,longitude:j.longitude??S.longitude,radius_meter:j.radius_meter??S.radius_meter,jam_masuk:j.jam_masuk?String(j.jam_masuk).slice(0,5):S.jam_masuk,jam_pulang:j.jam_pulang?String(j.jam_pulang).slice(0,5):S.jam_pulang,toleransi_telat:j.toleransi_telat??S.toleransi_telat})),L&&I.fire({icon:"success",title:"Berhasil",text:"Pengaturan berhasil direset dari server"})}catch(u){const j=u?.response?.data?.responseMessage||"Gagal memuat pengaturan dari server";L&&I.fire({icon:"error",title:"Gagal",text:j})}finally{n(!1)}},K=()=>new Promise(L=>{if(window.L)return L();const u=document.createElement("link");u.rel="stylesheet",u.href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css",u.onload=A,u.onerror=()=>{m({type:"error",message:"Gagal memuat stylesheet Leaflet."})},document.head.appendChild(u);const j=document.createElement("script");j.src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js",j.onload=A,j.onerror=()=>{m({type:"error",message:"Gagal memuat script Leaflet."}),R(!1)},document.body.appendChild(j);let S=0,y=0;function A(){if(S++,S===1&&P(D=>Math.max(D,50)),S===2){const D=setInterval(()=>{y++,window.L?(clearInterval(D),P(W=>Math.max(W,70)),L()):y>60&&(clearInterval(D),L())},50)}}}),w=async()=>{await K();const L=window.L;if(!L)return;const u=document.getElementById("map-picker");if(!u){M.current<5&&(M.current+=1,setTimeout(w,100));return}i.current&&(i.current.remove(),i.current=null),E.current={started:0,loaded:0},i.current=L.map(u).setView([a.latitude,a.longitude],17),v.current=!0,P(S=>Math.max(S,80));const j=L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{maxZoom:19});j.on("tileloadstart",()=>{E.current.started+=1;const{started:S,loaded:y}=E.current,A=y/Math.max(S,1),D=80+Math.floor(A*19);P(W=>Math.max(W,Math.min(99,D)))}),j.on("tileload",()=>{E.current.loaded+=1;const{started:S,loaded:y}=E.current,A=y/Math.max(S,1),D=80+Math.floor(A*19);P(W=>Math.max(W,Math.min(99,D)))}),j.on("load",()=>{P(100),setTimeout(()=>R(!1),300)}),j.on("tileerror",()=>{const{started:S,loaded:y}=E.current,A=y/Math.max(S,1),D=80+Math.floor(A*19);P(W=>Math.max(W,Math.min(99,D))),setTimeout(()=>R(!1),800)}),j.addTo(i.current),setTimeout(()=>{C&&(P(S=>Math.max(S,95)),R(!1))},5e3),c.current=L.marker([a.latitude,a.longitude],{draggable:!0}).addTo(i.current),c.current.on("dragend",S=>{const{lat:y,lng:A}=S.target.getLatLng();s(D=>({...D,latitude:y,longitude:A})),f.current&&f.current.setLatLng([y,A])}),i.current.on("click",S=>{const{lat:y,lng:A}=S.latlng;c.current.setLatLng([y,A]),s(D=>({...D,latitude:y,longitude:A})),f.current&&f.current.setLatLng([y,A])}),f.current&&(f.current.remove(),f.current=null),f.current=L.circle([a.latitude,a.longitude],{radius:Number(a.radius_meter)||0,color:"#4A90E2",weight:2,fillColor:"#4A90E2",fillOpacity:.15}).addTo(i.current)};r.useEffect(()=>{F()},[]);const v=r.useRef(!1);r.useEffect(()=>{!t&&!v.current&&w()},[t]),r.useEffect(()=>{!i.current||!c.current||!window.L||(c.current.setLatLng([a.latitude,a.longitude]),i.current.setView([a.latitude,a.longitude],17),f.current&&f.current.setLatLng([a.latitude,a.longitude]))},[a.latitude,a.longitude]),r.useEffect(()=>{if(!i.current||!f.current)return;const L=Number(a.radius_meter)||0;f.current.setRadius(L)},[a.radius_meter]),r.useEffect(()=>()=>{i.current&&(i.current.remove(),i.current=null),c.current=null,f.current&&(f.current.remove(),f.current=null)},[]);const d=L=>{const{name:u,value:j}=L.target;s(S=>({...S,[u]:j}))},k=async()=>{n(!0);try{const L={latitude:Number(a.latitude),longitude:Number(a.longitude),radius_meter:Number(a.radius_meter),jam_masuk:a.jam_masuk,jam_pulang:a.jam_pulang,toleransi_telat:Number(a.toleransi_telat)};await U.updateSettings(L),m({type:"success",message:"Pengaturan berhasil disimpan."}),I.fire({icon:"success",title:"Berhasil",text:"Pengaturan berhasil disimpan"})}catch(L){const u=L?.response?.data?.responseMessage||"Gagal menyimpan pengaturan. Periksa API backend.";m({type:"error",message:u}),I.fire({icon:"error",title:"Gagal",text:u})}finally{n(!1),setTimeout(()=>m(null),2e3)}},N=async()=>{if(console.log("[Geolocation] Mulai proses getCurrentLocation"),l){console.log("[Geolocation] Dibatalkan karena geoLoading masih true");return}if(!navigator.geolocation){console.warn("[Geolocation] navigator.geolocation tidak tersedia",{userAgent:navigator.userAgent,location:{protocol:window.location.protocol,hostname:window.location.hostname}}),I.fire({icon:"error",title:"GPS Tidak Tersedia",text:"Browser Anda tidak mendukung geolokasi atau GPS tidak tersedia.",confirmButtonColor:"#3b82f6"});return}const L=window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1",u=window.location.protocol==="https:";if(console.log("[Geolocation] Context",{isLocalhost:L,isHttps:u,protocol:window.location.protocol,hostname:window.location.hostname,existingFormCoords:{latitude:a.latitude,longitude:a.longitude}}),!u&&!L){console.warn("[Geolocation] Diblokir karena bukan HTTPS/localhost"),I.fire({icon:"warning",title:"Koneksi Tidak Aman",text:"Geolokasi memerlukan koneksi HTTPS atau localhost. Mohon akses melalui HTTPS atau localhost.",confirmButtonColor:"#3b82f6"});return}h(!0);const j=I.fire({title:"Mendapatkan Lokasi...",html:`
        <div class="text-sm text-gray-600 mb-4">
          Mohon tunggu, sedang mengambil koordinat GPS Anda.
        </div>
        <div class="text-xs text-gray-500">
          Pastikan Anda telah mengizinkan akses lokasi di browser.
        </div>
      `,allowOutsideClick:!1,allowEscapeKey:!1,showConfirmButton:!1,didOpen:()=>{I.showLoading()}});try{const S=_=>(console.log("[Geolocation] Memanggil navigator.geolocation.getCurrentPosition dengan options",_),new Promise((z,H)=>{navigator.geolocation.getCurrentPosition(z,H,_)}));let y;try{y=await S({enableHighAccuracy:!0,timeout:5e3,maximumAge:0}),console.log("[Geolocation] Berhasil (high accuracy)",{coords:{lat:y.coords.latitude,lng:y.coords.longitude,accuracy:y.coords.accuracy,altitude:y.coords.altitude,altitudeAccuracy:y.coords.altitudeAccuracy,heading:y.coords.heading,speed:y.coords.speed},timestamp:y.timestamp,source:"highAccuracy"})}catch(_){console.warn("[Geolocation] High accuracy gagal, coba low accuracy",{error:_,code:_?.code,message:_?.message}),y=await S({enableHighAccuracy:!1,timeout:1e4,maximumAge:0}),console.log("[Geolocation] Berhasil (low accuracy)",{coords:{lat:y.coords.latitude,lng:y.coords.longitude,accuracy:y.coords.accuracy,altitude:y.coords.altitude,altitudeAccuracy:y.coords.altitudeAccuracy,heading:y.coords.heading,speed:y.coords.speed},timestamp:y.timestamp,source:"lowAccuracy"})}const{latitude:A,longitude:D,accuracy:W}=y.coords;if(!A||!D||isNaN(A)||isNaN(D))throw new Error("Invalid coordinates received");console.log("[Geolocation] Koordinat diterima",{rawCoords:y.coords,usedCoords:{latitude:A,longitude:D}});const p=20,$=typeof W=="number"?W:null;if($!==null&&$>p){if(j.close(),console.warn("[Geolocation] Akurasi di atas threshold",{accuracy:$,threshold:p}),!(await I.fire({icon:"warning",title:"Akurasi GPS Rendah",html:`
            <div class="text-sm">
              Akurasi lokasi saat ini sekitar Â±${Math.round($)} meter.<br/>
              Titik lokasi bisa cukup jauh dari posisi sebenarnya.
            </div>
            <div class="text-xs text-gray-500 mt-3">
              Disarankan menggunakan <strong>HP (smartphone)</strong> dengan GPS aktif,<br/>
              dibandingkan laptop/PC yang biasanya hanya memakai lokasi perkiraan.
            </div>
          `,showCancelButton:!0,confirmButtonText:"Tetap Gunakan Titik Ini",cancelButtonText:"Batalkan",confirmButtonColor:"#3b82f6",cancelButtonColor:"#6b7280"})).isConfirmed){console.log("[Geolocation] Pengguna membatalkan penggunaan titik dengan akurasi rendah");return}}else j.close();if(s(_=>({..._,latitude:parseFloat(A.toFixed(6)),longitude:parseFloat(D.toFixed(6))})),i.current&&window.L){const _=window.L,z=[A,D];try{i.current.setView(z,17),c.current?c.current.setLatLng(z):(c.current=_.marker(z,{draggable:!0}).addTo(i.current),c.current.on("dragend",H=>{const O=H.target.getLatLng();s(q=>({...q,latitude:parseFloat(O.lat.toFixed(6)),longitude:parseFloat(O.lng.toFixed(6))}))})),f.current?(f.current.setLatLng(z),f.current.setRadius(Number(a.radius_meter)||50)):f.current=_.circle(z,{radius:Number(a.radius_meter)||50,color:"#3b82f6",weight:2,fillColor:"#3b82f6",fillOpacity:.15}).addTo(i.current)}catch(H){console.warn("Map update failed:",{error:H,newLatLng:z})}}I.fire({icon:"success",title:"Lokasi Berhasil Diambil!",html:`
          <div class="text-sm">
            <strong>Koordinat:</strong><br>
            Latitude: ${A.toFixed(6)}<br>
            Longitude: ${D.toFixed(6)}
          </div>
          <div class="text-xs text-gray-500 mt-2">
            Akurasi: Â±${Math.round(y.coords.accuracy||0)} meter
          </div>
        `,confirmButtonColor:"#3b82f6",timer:4e3,timerProgressBar:!0})}catch(S){console.error("[Geolocation] Terjadi error saat getCurrentLocation",{error:S,code:S?.code,message:S?.message,name:S?.name}),j&&j.isVisible&&j.isVisible()&&j.close();let y="Gagal mendapatkan lokasi. ",A="Gagal Mendapatkan Lokasi";if(S.code)switch(S.code){case 1:A="Akses Lokasi Ditolak",y="Mohon izinkan akses lokasi di browser Anda. Klik ikon kunci/lokasi di address bar untuk mengatur izin.";break;case 2:A="Lokasi Tidak Tersedia",y="Informasi lokasi tidak tersedia. Pastikan GPS aktif dan Anda berada di area dengan sinyal yang baik.";break;case 3:A="Waktu Tunggu Habis",y="Waktu tunggu habis. Pastikan GPS aktif dan coba lagi.";break;default:y+="Terjadi kesalahan yang tidak diketahui.";break}else y+=S.message||"Terjadi kesalahan yang tidak diketahui.";I.fire({icon:"error",title:A,text:y,confirmButtonColor:"#3b82f6",footer:"<small>Tips: Pastikan browser mengizinkan akses lokasi dan GPS aktif</small>"})}finally{h(!1)}};return t&&!i.current?e.jsx(Pe,{text:"Memuat pengaturan..."}):e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx(ze,{notification:g}),e.jsx("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6 border border-gray-200",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Pilih Lokasi Sekolah"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{id:"map-picker",className:"w-full h-[380px] rounded-lg overflow-hidden border"}),C&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-white/80",children:e.jsxs("div",{className:"w-72 bg-white rounded-lg shadow p-4 text-center",children:[e.jsx("div",{className:"text-sm font-medium text-gray-700",children:"Memuat peta..."}),e.jsx("div",{className:"mt-2 h-2 w-full bg-gray-200 rounded",children:e.jsx("div",{className:"h-2 bg-blue-600 rounded",style:{width:`${b}%`}})}),e.jsxs("div",{className:"mt-2 text-xs text-gray-600",children:[b,"%"]})]})})]}),e.jsx("div",{className:"mt-4 flex justify-center",children:e.jsx("button",{onClick:N,disabled:t||l,className:"flex items-center gap-2 bg-green-600 hover:bg-green-700 disabled:bg-gray-400 disabled:cursor-not-allowed text-white px-6 py-3 rounded-lg text-sm font-medium transition-all duration-200 shadow-md hover:shadow-lg",children:l?e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"w-5 h-5 animate-spin",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"Mengambil Lokasi..."]}):e.jsxs(e.Fragment,{children:[e.jsxs("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})]}),"Gunakan Lokasi Saat Ini"]})})}),e.jsx("div",{className:"mt-2 text-center",children:e.jsx("p",{className:"text-xs text-gray-500",children:"Pastikan browser mengizinkan akses lokasi dan GPS aktif"})}),e.jsx("p",{className:"mt-3 text-sm text-gray-600",children:"Klik pada peta atau seret marker untuk mengatur lokasi. Latitude dan longitude akan terisi otomatis."})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6 border border-gray-200",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Konfigurasi Sistem"}),e.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Latitude"}),e.jsx("input",{type:"number",step:"0.000001",name:"latitude",value:a.latitude,onChange:d,className:"w-full px-3 py-2 border border-gray-300 rounded-md"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Longitude"}),e.jsx("input",{type:"number",step:"0.000001",name:"longitude",value:a.longitude,onChange:d,className:"w-full px-3 py-2 border border-gray-300 rounded-md"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Radius (meter)"}),e.jsx("input",{type:"number",min:"10",name:"radius_meter",value:a.radius_meter,onChange:d,className:"w-full px-3 py-2 border border-gray-300 rounded-md"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Jam Datang"}),e.jsx("input",{type:"time",name:"jam_masuk",value:a.jam_masuk,onChange:d,className:"w-full px-3 py-2 border border-gray-300 rounded-md"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Jam Pulang"}),e.jsx("input",{type:"time",name:"jam_pulang",value:a.jam_pulang,onChange:d,className:"w-full px-3 py-2 border border-gray-300 rounded-md"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Toleransi Terlambat Jam Datang (menit)"}),e.jsx("input",{type:"number",min:"0",name:"toleransi_telat",value:a.toleransi_telat,onChange:d,className:"w-full px-3 py-2 border border-gray-300 rounded-md"})]}),e.jsx("div",{className:"mt-2 ",children:e.jsx("button",{disabled:t,onClick:k,className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg text-sm font-medium disabled:opacity-50 w-full",children:"Simpan"})})]})]})]})})]})}const es=Object.freeze(Object.defineProperty({__proto__:null,default:wa},Symbol.toStringTag,{value:"Module"}));export{Ia as A,Ka as B,Ga as C,Wa as D,Aa as E,Oa as F,Ya as G,es as H,Qa as I,Xa as K,Pe as L,ze as N,Ja as P,Ra as R,qa as S,fe as T,Za as U,x as a,De as b,te as c,Ge as d,Q as e,se as f,ie as g,Pa as h,Va as i,ke as j,Ta as k,Ua as l,Fa as m,Ea as n,Ba as o,$a as p,Da as q,U as r,_a as s,Ca as t,ge as u,Ma as v,ha as w,He as x,za as y,Ha as z};
