import{j as s}from"./query-vendor-CL32O2jR.js";import{r as T,R as A}from"./router-vendor-CjMceo_z.js";import{T as Re,u as re,g as $,L as ve,E as Ee,a as Me}from"./admin-pages-BrFGn-Vk.js";import{u as X,w as _e,E as $e}from"./utils-vendor-Ci91RTtW.js";import{S as L}from"./ui-vendor-DAzBgmXi.js";function ye(t,e,r,a,n){a=a||{};var i=1.15,l=n.internal.scaleFactor,h=n.internal.getFontSize()/l,d=n.getLineHeightFactor?n.getLineHeightFactor():i,o=h*d,u=/\r\n|\r|\n/g,c="",m=1;if((a.valign==="middle"||a.valign==="bottom"||a.halign==="center"||a.halign==="right")&&(c=typeof t=="string"?t.split(u):t,m=c.length||1),r+=h*(2-i),a.valign==="middle"?r-=m/2*o:a.valign==="bottom"&&(r-=m*o),a.halign==="center"||a.halign==="right"){var x=h;if(a.halign==="center"&&(x*=.5),c&&m>=1){for(var v=0;v<c.length;v++)n.text(c[v],e-n.getStringUnitWidth(c[v])*x,r),r+=o;return n}e-=n.getStringUnitWidth(t)*x}return a.halign==="justify"?n.text(t,e,r,{maxWidth:a.maxWidth||100,align:"justify"}):n.text(t,e,r),n}var ue={},I=(function(){function t(e){this.jsPDFDocument=e,this.userStyles={textColor:e.getTextColor?this.jsPDFDocument.getTextColor():0,fontSize:e.internal.getFontSize(),fontStyle:e.internal.getFont().fontStyle,font:e.internal.getFont().fontName,lineWidth:e.getLineWidth?this.jsPDFDocument.getLineWidth():0,lineColor:e.getDrawColor?this.jsPDFDocument.getDrawColor():0}}return t.setDefaults=function(e,r){r===void 0&&(r=null),r?r.__autoTableDocumentDefaults=e:ue=e},t.unifyColor=function(e){return Array.isArray(e)?e:typeof e=="number"?[e,e,e]:typeof e=="string"?[e]:null},t.prototype.applyStyles=function(e,r){var a,n,i;r===void 0&&(r=!1),e.fontStyle&&this.jsPDFDocument.setFontStyle&&this.jsPDFDocument.setFontStyle(e.fontStyle);var l=this.jsPDFDocument.internal.getFont(),h=l.fontStyle,d=l.fontName;if(e.font&&(d=e.font),e.fontStyle){h=e.fontStyle;var o=this.getFontList()[d];o&&o.indexOf(h)===-1&&this.jsPDFDocument.setFontStyle&&(this.jsPDFDocument.setFontStyle(o[0]),h=o[0])}if(this.jsPDFDocument.setFont(d,h),e.fontSize&&this.jsPDFDocument.setFontSize(e.fontSize),!r){var u=t.unifyColor(e.fillColor);u&&(a=this.jsPDFDocument).setFillColor.apply(a,u),u=t.unifyColor(e.textColor),u&&(n=this.jsPDFDocument).setTextColor.apply(n,u),u=t.unifyColor(e.lineColor),u&&(i=this.jsPDFDocument).setDrawColor.apply(i,u),typeof e.lineWidth=="number"&&this.jsPDFDocument.setLineWidth(e.lineWidth)}},t.prototype.splitTextToSize=function(e,r,a){return this.jsPDFDocument.splitTextToSize(e,r,a)},t.prototype.rect=function(e,r,a,n,i){return this.jsPDFDocument.rect(e,r,a,n,i)},t.prototype.getLastAutoTable=function(){return this.jsPDFDocument.lastAutoTable||null},t.prototype.getTextWidth=function(e){return this.jsPDFDocument.getTextWidth(e)},t.prototype.getDocument=function(){return this.jsPDFDocument},t.prototype.setPage=function(e){this.jsPDFDocument.setPage(e)},t.prototype.addPage=function(){return this.jsPDFDocument.addPage()},t.prototype.getFontList=function(){return this.jsPDFDocument.getFontList()},t.prototype.getGlobalOptions=function(){return ue||{}},t.prototype.getDocumentOptions=function(){return this.jsPDFDocument.__autoTableDocumentDefaults||{}},t.prototype.pageSize=function(){var e=this.jsPDFDocument.internal.pageSize;return e.width==null&&(e={width:e.getWidth(),height:e.getHeight()}),e},t.prototype.scaleFactor=function(){return this.jsPDFDocument.internal.scaleFactor},t.prototype.getLineHeightFactor=function(){var e=this.jsPDFDocument;return e.getLineHeightFactor?e.getLineHeightFactor():1.15},t.prototype.getLineHeight=function(e){return e/this.scaleFactor()*this.getLineHeightFactor()},t.prototype.pageNumber=function(){var e=this.jsPDFDocument.internal.getCurrentPageInfo();return e?e.pageNumber:this.jsPDFDocument.internal.getNumberOfPages()},t})(),ne=function(t,e){return ne=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,a){r.__proto__=a}||function(r,a){for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(r[n]=a[n])},ne(t,e)};function be(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");ne(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var we=(function(t){be(e,t);function e(r){var a=t.call(this)||this;return a._element=r,a}return e})(Array);function Ie(t){return{font:"helvetica",fontStyle:"normal",overflow:"linebreak",fillColor:!1,textColor:20,halign:"left",valign:"top",fontSize:10,cellPadding:5/t,lineColor:200,lineWidth:0,cellWidth:"auto",minCellHeight:0,minCellWidth:0}}function Ke(t){var e={striped:{table:{fillColor:255,textColor:80,fontStyle:"normal"},head:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},body:{},foot:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},alternateRow:{fillColor:245}},grid:{table:{fillColor:255,textColor:80,fontStyle:"normal",lineWidth:.1},head:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},body:{},foot:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},alternateRow:{}},plain:{head:{fontStyle:"bold"},foot:{fontStyle:"bold"}}};return e[t]}function G(t,e,r){r.applyStyles(e,!0);var a=Array.isArray(t)?t:[t],n=a.map(function(i){return r.getTextWidth(i)}).reduce(function(i,l){return Math.max(i,l)},0);return n}function Se(t,e,r,a){var n=e.settings.tableLineWidth,i=e.settings.tableLineColor;t.applyStyles({lineWidth:n,lineColor:i});var l=je(n,!1);l&&t.rect(r.x,r.y,e.getWidth(t.pageSize().width),a.y-r.y,l)}function je(t,e){var r=t>0,a=e||e===0;return r&&a?"DF":r?"S":a?"F":null}function J(t,e){var r,a,n,i;if(t=t||e,Array.isArray(t)){if(t.length>=4)return{top:t[0],right:t[1],bottom:t[2],left:t[3]};if(t.length===3)return{top:t[0],right:t[1],bottom:t[2],left:t[1]};if(t.length===2)return{top:t[0],right:t[1],bottom:t[0],left:t[1]};t.length===1?t=t[0]:t=e}return typeof t=="object"?(typeof t.vertical=="number"&&(t.top=t.vertical,t.bottom=t.vertical),typeof t.horizontal=="number"&&(t.right=t.horizontal,t.left=t.horizontal),{left:(r=t.left)!==null&&r!==void 0?r:e,top:(a=t.top)!==null&&a!==void 0?a:e,right:(n=t.right)!==null&&n!==void 0?n:e,bottom:(i=t.bottom)!==null&&i!==void 0?i:e}):(typeof t!="number"&&(t=e),{top:t,right:t,bottom:t,left:t})}function ke(t,e){var r=J(e.settings.margin,0);return t.pageSize().width-(r.left+r.right)}function Oe(t,e,r,a,n){var i={},l=1.3333333333333333,h=V(e,function(S){return n.getComputedStyle(S).backgroundColor});h!=null&&(i.fillColor=h);var d=V(e,function(S){return n.getComputedStyle(S).color});d!=null&&(i.textColor=d);var o=Ue(a,r);o&&(i.cellPadding=o);var u="borderTopColor",c=l*r,m=a.borderTopWidth;if(a.borderBottomWidth===m&&a.borderRightWidth===m&&a.borderLeftWidth===m){var x=(parseFloat(m)||0)/c;x&&(i.lineWidth=x)}else i.lineWidth={top:(parseFloat(a.borderTopWidth)||0)/c,right:(parseFloat(a.borderRightWidth)||0)/c,bottom:(parseFloat(a.borderBottomWidth)||0)/c,left:(parseFloat(a.borderLeftWidth)||0)/c},i.lineWidth.top||(i.lineWidth.right?u="borderRightColor":i.lineWidth.bottom?u="borderBottomColor":i.lineWidth.left&&(u="borderLeftColor"));var v=V(e,function(S){return n.getComputedStyle(S)[u]});v!=null&&(i.lineColor=v);var N=["left","right","center","justify"];N.indexOf(a.textAlign)!==-1&&(i.halign=a.textAlign),N=["middle","bottom","top"],N.indexOf(a.verticalAlign)!==-1&&(i.valign=a.verticalAlign);var p=parseInt(a.fontSize||"");isNaN(p)||(i.fontSize=p/l);var y=Ye(a);y&&(i.fontStyle=y);var w=(a.fontFamily||"").toLowerCase();return t.indexOf(w)!==-1&&(i.font=w),i}function Ye(t){var e="";return(t.fontWeight==="bold"||t.fontWeight==="bolder"||parseInt(t.fontWeight)>=700)&&(e="bold"),(t.fontStyle==="italic"||t.fontStyle==="oblique")&&(e+="italic"),e}function V(t,e){var r=Ne(t,e);if(!r)return null;var a=r.match(/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d*\.?\d*))?\)$/);if(!a||!Array.isArray(a))return null;var n=[parseInt(a[1]),parseInt(a[2]),parseInt(a[3])],i=parseInt(a[4]);return i===0||isNaN(n[0])||isNaN(n[1])||isNaN(n[2])?null:n}function Ne(t,e){var r=e(t);return r==="rgba(0, 0, 0, 0)"||r==="transparent"||r==="initial"||r==="inherit"?t.parentElement==null?null:Ne(t.parentElement,e):r}function Ue(t,e){var r=[t.paddingTop,t.paddingRight,t.paddingBottom,t.paddingLeft],a=96/(72/e),n=(parseInt(t.lineHeight)-parseInt(t.fontSize))/e/2,i=r.map(function(h){return parseInt(h||"0")/a}),l=J(i,0);return n>l.top&&(l.top=n),n>l.bottom&&(l.bottom=n),l}function Ce(t,e,r,a,n){var i,l;a===void 0&&(a=!1),n===void 0&&(n=!1);var h;typeof e=="string"?h=r.document.querySelector(e):h=e;var d=Object.keys(t.getFontList()),o=t.scaleFactor(),u=[],c=[],m=[];if(!h)return console.error("Html table could not be found with input: ",e),{head:u,body:c,foot:m};for(var x=0;x<h.rows.length;x++){var v=h.rows[x],N=(l=(i=v?.parentElement)===null||i===void 0?void 0:i.tagName)===null||l===void 0?void 0:l.toLowerCase(),p=Ge(d,o,r,v,a,n);p&&(N==="thead"?u.push(p):N==="tfoot"?m.push(p):c.push(p))}return{head:u,body:c,foot:m}}function Ge(t,e,r,a,n,i){for(var l=new we(a),h=0;h<a.cells.length;h++){var d=a.cells[h],o=r.getComputedStyle(d);if(n||o.display!=="none"){var u=void 0;i&&(u=Oe(t,d,e,o,r)),l.push({rowSpan:d.rowSpan,colSpan:d.colSpan,styles:u,_element:d,content:qe(d)})}}var c=r.getComputedStyle(a);if(l.length>0&&(n||c.display!=="none"))return l}function qe(t){var e=t.cloneNode(!0);return e.innerHTML=e.innerHTML.replace(/\n/g,"").replace(/ +/g," "),e.innerHTML=e.innerHTML.split(/<br.*?>/).map(function(r){return r.trim()}).join(`
`),e.innerText||e.textContent||""}function Je(t,e,r){for(var a=0,n=[t,e,r];a<n.length;a++){var i=n[a];i&&typeof i!="object"&&console.error("The options parameter should be of type object, is: "+typeof i),i.startY&&typeof i.startY!="number"&&(console.error("Invalid value for startY option",i.startY),delete i.startY)}}function B(t,e,r,a,n){if(t==null)throw new TypeError("Cannot convert undefined or null to object");for(var i=Object(t),l=1;l<arguments.length;l++){var h=arguments[l];if(h!=null)for(var d in h)Object.prototype.hasOwnProperty.call(h,d)&&(i[d]=h[d])}return i}function Pe(t,e){var r=new I(t),a=r.getDocumentOptions(),n=r.getGlobalOptions();Je(n,a,e);var i=B({},n,a,e),l;typeof window<"u"&&(l=window);var h=Ze(n,a,e),d=Qe(n,a,e),o=Xe(r,i),u=et(r,i,l);return{id:e.tableId,content:u,hooks:d,styles:h,settings:o}}function Ze(t,e,r){for(var a={styles:{},headStyles:{},bodyStyles:{},footStyles:{},alternateRowStyles:{},columnStyles:{}},n=function(d){if(d==="columnStyles"){var o=t[d],u=e[d],c=r[d];a.columnStyles=B({},o,u,c)}else{var m=[t,e,r],x=m.map(function(v){return v[d]||{}});a[d]=B({},x[0],x[1],x[2])}},i=0,l=Object.keys(a);i<l.length;i++){var h=l[i];n(h)}return a}function Qe(t,e,r){for(var a=[t,e,r],n={didParseCell:[],willDrawCell:[],didDrawCell:[],willDrawPage:[],didDrawPage:[]},i=0,l=a;i<l.length;i++){var h=l[i];h.didParseCell&&n.didParseCell.push(h.didParseCell),h.willDrawCell&&n.willDrawCell.push(h.willDrawCell),h.didDrawCell&&n.didDrawCell.push(h.didDrawCell),h.willDrawPage&&n.willDrawPage.push(h.willDrawPage),h.didDrawPage&&n.didDrawPage.push(h.didDrawPage)}return n}function Xe(t,e){var r,a,n,i,l,h,d,o,u,c,m,x,v=J(e.margin,40/t.scaleFactor()),N=(r=Ve(t,e.startY))!==null&&r!==void 0?r:v.top,p;e.showFoot===!0?p="everyPage":e.showFoot===!1?p="never":p=(a=e.showFoot)!==null&&a!==void 0?a:"everyPage";var y;e.showHead===!0?y="everyPage":e.showHead===!1?y="never":y=(n=e.showHead)!==null&&n!==void 0?n:"everyPage";var w=(i=e.useCss)!==null&&i!==void 0?i:!1,S=e.theme||(w?"plain":"striped"),k=!!e.horizontalPageBreak,C=(l=e.horizontalPageBreakRepeat)!==null&&l!==void 0?l:null;return{includeHiddenHtml:(h=e.includeHiddenHtml)!==null&&h!==void 0?h:!1,useCss:w,theme:S,startY:N,margin:v,pageBreak:(d=e.pageBreak)!==null&&d!==void 0?d:"auto",rowPageBreak:(o=e.rowPageBreak)!==null&&o!==void 0?o:"auto",tableWidth:(u=e.tableWidth)!==null&&u!==void 0?u:"auto",showHead:y,showFoot:p,tableLineWidth:(c=e.tableLineWidth)!==null&&c!==void 0?c:0,tableLineColor:(m=e.tableLineColor)!==null&&m!==void 0?m:200,horizontalPageBreak:k,horizontalPageBreakRepeat:C,horizontalPageBreakBehaviour:(x=e.horizontalPageBreakBehaviour)!==null&&x!==void 0?x:"afterAllRows"}}function Ve(t,e){var r=t.getLastAutoTable(),a=t.scaleFactor(),n=t.pageNumber(),i=!1;if(r&&r.startPageNumber){var l=r.startPageNumber+r.pageNumber-1;i=l===n}return typeof e=="number"?e:(e==null||e===!1)&&i&&r?.finalY!=null?r.finalY+20/a:null}function et(t,e,r){var a=e.head||[],n=e.body||[],i=e.foot||[];if(e.html){var l=e.includeHiddenHtml;if(r){var h=Ce(t,e.html,r,l,e.useCss)||{};a=h.head||a,n=h.body||a,i=h.foot||a}else console.error("Cannot parse html in non browser environment")}var d=e.columns||tt(a,n,i);return{columns:d,head:a,body:n,foot:i}}function tt(t,e,r){var a=t[0]||e[0]||r[0]||[],n=[];return Object.keys(a).filter(function(i){return i!=="_element"}).forEach(function(i){var l=1,h;Array.isArray(a)?h=a[parseInt(i)]:h=a[i],typeof h=="object"&&!Array.isArray(h)&&(l=h?.colSpan||1);for(var d=0;d<l;d++){var o=void 0;Array.isArray(a)?o=n.length:o=i+(d>0?"_".concat(d):"");var u={dataKey:o};n.push(u)}}),n}var ie=(function(){function t(e,r,a){this.table=r,this.pageNumber=r.pageNumber,this.settings=r.settings,this.cursor=a,this.doc=e.getDocument()}return t})(),at=(function(t){be(e,t);function e(r,a,n,i,l,h){var d=t.call(this,r,a,h)||this;return d.cell=n,d.row=i,d.column=l,d.section=i.section,d}return e})(ie),rt=(function(){function t(e,r){this.pageNumber=1,this.id=e.id,this.settings=e.settings,this.styles=e.styles,this.hooks=e.hooks,this.columns=r.columns,this.head=r.head,this.body=r.body,this.foot=r.foot}return t.prototype.getHeadHeight=function(e){return this.head.reduce(function(r,a){return r+a.getMaxCellHeight(e)},0)},t.prototype.getFootHeight=function(e){return this.foot.reduce(function(r,a){return r+a.getMaxCellHeight(e)},0)},t.prototype.allRows=function(){return this.head.concat(this.body).concat(this.foot)},t.prototype.callCellHooks=function(e,r,a,n,i,l){for(var h=0,d=r;h<d.length;h++){var o=d[h],u=new at(e,this,a,n,i,l),c=o(u)===!1;if(a.text=Array.isArray(a.text)?a.text:[a.text],c)return!1}return!0},t.prototype.callEndPageHooks=function(e,r){e.applyStyles(e.userStyles);for(var a=0,n=this.hooks.didDrawPage;a<n.length;a++){var i=n[a];i(new ie(e,this,r))}},t.prototype.callWillDrawPageHooks=function(e,r){for(var a=0,n=this.hooks.willDrawPage;a<n.length;a++){var i=n[a];i(new ie(e,this,r))}},t.prototype.getWidth=function(e){if(typeof this.settings.tableWidth=="number")return this.settings.tableWidth;if(this.settings.tableWidth==="wrap"){var r=this.columns.reduce(function(n,i){return n+i.wrappedWidth},0);return r}else{var a=this.settings.margin;return e-a.left-a.right}},t})(),De=(function(){function t(e,r,a,n,i){i===void 0&&(i=!1),this.height=0,this.raw=e,e instanceof we&&(this.raw=e._element,this.element=e._element),this.index=r,this.section=a,this.cells=n,this.spansMultiplePages=i}return t.prototype.getMaxCellHeight=function(e){var r=this;return e.reduce(function(a,n){var i;return Math.max(a,((i=r.cells[n.index])===null||i===void 0?void 0:i.height)||0)},0)},t.prototype.hasRowSpan=function(e){var r=this;return e.filter(function(a){var n=r.cells[a.index];return n?n.rowSpan>1:!1}).length>0},t.prototype.canEntireRowFit=function(e,r){return this.getMaxCellHeight(r)<=e},t.prototype.getMinimumRowHeight=function(e,r){var a=this;return e.reduce(function(n,i){var l=a.cells[i.index];if(!l)return 0;var h=r.getLineHeight(l.styles.fontSize),d=l.padding("vertical"),o=d+h;return o>n?o:n},0)},t})(),Fe=(function(){function t(e,r,a){var n;this.contentHeight=0,this.contentWidth=0,this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.height=0,this.x=0,this.y=0,this.styles=r,this.section=a,this.raw=e;var i=e;e!=null&&typeof e=="object"&&!Array.isArray(e)?(this.rowSpan=e.rowSpan||1,this.colSpan=e.colSpan||1,i=(n=e.content)!==null&&n!==void 0?n:e,e._element&&(this.raw=e._element)):(this.rowSpan=1,this.colSpan=1);var l=i!=null?""+i:"",h=/\r\n|\r|\n/g;this.text=l.split(h)}return t.prototype.getTextPos=function(){var e;if(this.styles.valign==="top")e=this.y+this.padding("top");else if(this.styles.valign==="bottom")e=this.y+this.height-this.padding("bottom");else{var r=this.height-this.padding("vertical");e=this.y+r/2+this.padding("top")}var a;if(this.styles.halign==="right")a=this.x+this.width-this.padding("right");else if(this.styles.halign==="center"){var n=this.width-this.padding("horizontal");a=this.x+n/2+this.padding("left")}else a=this.x+this.padding("left");return{x:a,y:e}},t.prototype.getContentHeight=function(e,r){r===void 0&&(r=1.15);var a=Array.isArray(this.text)?this.text.length:1,n=this.styles.fontSize/e*r,i=a*n+this.padding("vertical");return Math.max(i,this.styles.minCellHeight)},t.prototype.padding=function(e){var r=J(this.styles.cellPadding,0);return e==="vertical"?r.top+r.bottom:e==="horizontal"?r.left+r.right:r[e]},t})(),nt=(function(){function t(e,r,a){this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.dataKey=e,this.raw=r,this.index=a}return t.prototype.getMaxCustomCellWidth=function(e){for(var r=0,a=0,n=e.allRows();a<n.length;a++){var i=n[a],l=i.cells[this.index];l&&typeof l.styles.cellWidth=="number"&&(r=Math.max(r,l.styles.cellWidth))}return r},t})();function it(t,e){st(t,e);var r=[],a=0;e.columns.forEach(function(i){var l=i.getMaxCustomCellWidth(e);l?i.width=l:(i.width=i.wrappedWidth,r.push(i)),a+=i.width});var n=e.getWidth(t.pageSize().width)-a;n&&(n=se(r,n,function(i){return Math.max(i.minReadableWidth,i.minWidth)})),n&&(n=se(r,n,function(i){return i.minWidth})),n=Math.abs(n),!e.settings.horizontalPageBreak&&n>.1/t.scaleFactor()&&(n=n<1?n:Math.round(n),console.log("Of the table content, ".concat(n," units width could not fit page"))),lt(e),dt(e,t),ot(e)}function st(t,e){var r=t.scaleFactor(),a=e.settings.horizontalPageBreak,n=ke(t,e);e.allRows().forEach(function(i){for(var l=0,h=e.columns;l<h.length;l++){var d=h[l],o=i.cells[d.index];if(o){var u=e.hooks.didParseCell;e.callCellHooks(t,u,o,i,d,null);var c=o.padding("horizontal");o.contentWidth=G(o.text,o.styles,t)+c;var m=G(o.text.join(" ").split(/[^\S\u00A0]+/),o.styles,t);if(o.minReadableWidth=m+o.padding("horizontal"),typeof o.styles.cellWidth=="number")o.minWidth=o.styles.cellWidth,o.wrappedWidth=o.styles.cellWidth;else if(o.styles.cellWidth==="wrap"||a===!0)o.contentWidth>n?(o.minWidth=n,o.wrappedWidth=n):(o.minWidth=o.contentWidth,o.wrappedWidth=o.contentWidth);else{var x=10/r;o.minWidth=o.styles.minCellWidth||x,o.wrappedWidth=o.contentWidth,o.minWidth>o.wrappedWidth&&(o.wrappedWidth=o.minWidth)}}}}),e.allRows().forEach(function(i){for(var l=0,h=e.columns;l<h.length;l++){var d=h[l],o=i.cells[d.index];if(o&&o.colSpan===1)d.wrappedWidth=Math.max(d.wrappedWidth,o.wrappedWidth),d.minWidth=Math.max(d.minWidth,o.minWidth),d.minReadableWidth=Math.max(d.minReadableWidth,o.minReadableWidth);else{var u=e.styles.columnStyles[d.dataKey]||e.styles.columnStyles[d.index]||{},c=u.cellWidth||u.minCellWidth;c&&typeof c=="number"&&(d.minWidth=c,d.wrappedWidth=c)}o&&(o.colSpan>1&&!d.minWidth&&(d.minWidth=o.minWidth),o.colSpan>1&&!d.wrappedWidth&&(d.wrappedWidth=o.minWidth))}})}function se(t,e,r){for(var a=e,n=t.reduce(function(x,v){return x+v.wrappedWidth},0),i=0;i<t.length;i++){var l=t[i],h=l.wrappedWidth/n,d=a*h,o=l.width+d,u=r(l),c=o<u?u:o;e-=c-l.width,l.width=c}if(e=Math.round(e*1e10)/1e10,e){var m=t.filter(function(x){return e<0?x.width>r(x):!0});m.length&&(e=se(m,e,r))}return e}function ot(t){for(var e={},r=1,a=t.allRows(),n=0;n<a.length;n++)for(var i=a[n],l=0,h=t.columns;l<h.length;l++){var d=h[l],o=e[d.index];if(r>1)r--,delete i.cells[d.index];else if(o)o.cell.height+=i.height,r=o.cell.colSpan,delete i.cells[d.index],o.left--,o.left<=1&&delete e[d.index];else{var u=i.cells[d.index];if(!u)continue;if(u.height=i.height,u.rowSpan>1){var c=a.length-n,m=u.rowSpan>c?c:u.rowSpan;e[d.index]={cell:u,left:m,row:i}}}}}function lt(t){for(var e=t.allRows(),r=0;r<e.length;r++)for(var a=e[r],n=null,i=0,l=0,h=0;h<t.columns.length;h++){var d=t.columns[h];if(l-=1,l>1&&t.columns[h+1])i+=d.width,delete a.cells[d.index];else if(n){var o=n;delete a.cells[d.index],n=null,o.width=d.width+i}else{var o=a.cells[d.index];if(!o)continue;if(l=o.colSpan,i=0,o.colSpan>1){n=o,i+=d.width;continue}o.width=d.width+i}}}function dt(t,e){for(var r={count:0,height:0},a=0,n=t.allRows();a<n.length;a++){for(var i=n[a],l=0,h=t.columns;l<h.length;l++){var d=h[l],o=i.cells[d.index];if(o){e.applyStyles(o.styles,!0);var u=o.width-o.padding("horizontal");if(o.styles.overflow==="linebreak")o.text=e.splitTextToSize(o.text,u+1/e.scaleFactor(),{fontSize:o.styles.fontSize});else if(o.styles.overflow==="ellipsize")o.text=fe(o.text,u,o.styles,e,"...");else if(o.styles.overflow==="hidden")o.text=fe(o.text,u,o.styles,e,"");else if(typeof o.styles.overflow=="function"){var c=o.styles.overflow(o.text,u);typeof c=="string"?o.text=[c]:o.text=c}o.contentHeight=o.getContentHeight(e.scaleFactor(),e.getLineHeightFactor());var m=o.contentHeight/o.rowSpan;o.rowSpan>1&&r.count*r.height<m*o.rowSpan?r={height:m,count:o.rowSpan}:r&&r.count>0&&r.height>m&&(m=r.height),m>i.height&&(i.height=m)}}r.count--}}function fe(t,e,r,a,n){return t.map(function(i){return ht(i,e,r,a,n)})}function ht(t,e,r,a,n){var i=1e4*a.scaleFactor();if(e=Math.ceil(e*i)/i,e>=G(t,r,a))return t;for(;e<G(t+n,r,a)&&!(t.length<=1);)t=t.substring(0,t.length-1);return t.trim()+n}function Ae(t,e){var r=new I(t),a=ut(e,r.scaleFactor()),n=new rt(e,a);return it(r,n),r.applyStyles(r.userStyles),n}function ut(t,e){var r=t.content,a=ct(r.columns);if(r.head.length===0){var n=ce(a,"head");n&&r.head.push(n)}if(r.foot.length===0){var n=ce(a,"foot");n&&r.foot.push(n)}var i=t.settings.theme,l=t.styles;return{columns:a,head:ee("head",r.head,a,l,i,e),body:ee("body",r.body,a,l,i,e),foot:ee("foot",r.foot,a,l,i,e)}}function ee(t,e,r,a,n,i){var l={},h=e.map(function(d,o){for(var u=0,c={},m=0,x=0,v=0,N=r;v<N.length;v++){var p=N[v];if(l[p.index]==null||l[p.index].left===0)if(x===0){var y=void 0;Array.isArray(d)?y=d[p.index-m-u]:y=d[p.dataKey];var w={};typeof y=="object"&&!Array.isArray(y)&&(w=y?.styles||{});var S=gt(t,p,o,n,a,i,w),k=new Fe(y,S,t);c[p.dataKey]=k,c[p.index]=k,x=k.colSpan-1,l[p.index]={left:k.rowSpan-1,times:x}}else x--,m++;else l[p.index].left--,x=l[p.index].times,u++}return new De(d,o,t,c)});return h}function ce(t,e){var r={};return t.forEach(function(a){if(a.raw!=null){var n=ft(e,a.raw);n!=null&&(r[a.dataKey]=n)}}),Object.keys(r).length>0?r:null}function ft(t,e){if(t==="head"){if(typeof e=="object")return e.header||null;if(typeof e=="string"||typeof e=="number")return e}else if(t==="foot"&&typeof e=="object")return e.footer;return null}function ct(t){return t.map(function(e,r){var a,n;return typeof e=="object"?n=(a=e.dataKey)!==null&&a!==void 0?a:r:n=r,new nt(n,e,r)})}function gt(t,e,r,a,n,i,l){var h=Ke(a),d;t==="head"?d=n.headStyles:t==="body"?d=n.bodyStyles:t==="foot"&&(d=n.footStyles);var o=B({},h.table,h[t],n.styles,d),u=n.columnStyles[e.dataKey]||n.columnStyles[e.index]||{},c=t==="body"?u:{},m=t==="body"&&r%2===0?B({},h.alternateRow,n.alternateRowStyles):{},x=Ie(i),v=B({},x,o,m,c);return B(v,l)}function mt(t,e,r){var a;r===void 0&&(r={});var n=ke(t,e),i=new Map,l=[],h=[],d=[];Array.isArray(e.settings.horizontalPageBreakRepeat)?d=e.settings.horizontalPageBreakRepeat:(typeof e.settings.horizontalPageBreakRepeat=="string"||typeof e.settings.horizontalPageBreakRepeat=="number")&&(d=[e.settings.horizontalPageBreakRepeat]),d.forEach(function(m){var x=e.columns.find(function(v){return v.dataKey===m||v.index===m});x&&!i.has(x.index)&&(i.set(x.index,!0),l.push(x.index),h.push(e.columns[x.index]),n-=x.wrappedWidth)});for(var o=!0,u=(a=r?.start)!==null&&a!==void 0?a:0;u<e.columns.length;){if(i.has(u)){u++;continue}var c=e.columns[u].wrappedWidth;if(o||n>=c)o=!1,l.push(u),h.push(e.columns[u]),n-=c;else break;u++}return{colIndexes:l,columns:h,lastIndex:u-1}}function pt(t,e){for(var r=[],a=0;a<e.columns.length;a++){var n=mt(t,e,{start:a});n.columns.length&&(r.push(n),a=n.lastIndex)}return r}function Te(t,e){var r=e.settings,a=r.startY,n=r.margin,i={x:n.left,y:a},l=e.getHeadHeight(e.columns)+e.getFootHeight(e.columns),h=a+n.bottom+l;if(r.pageBreak==="avoid"){var d=e.body,o=d.reduce(function(m,x){return m+x.height},0);h+=o}var u=new I(t);(r.pageBreak==="always"||r.startY!=null&&h>u.pageSize().height)&&(We(u),i.y=n.top),e.callWillDrawPageHooks(u,i);var c=B({},i);e.startPageNumber=u.pageNumber(),r.horizontalPageBreak?xt(u,e,c,i):(u.applyStyles(u.userStyles),(r.showHead==="firstPage"||r.showHead==="everyPage")&&e.head.forEach(function(m){return R(u,e,m,i,e.columns)}),u.applyStyles(u.userStyles),e.body.forEach(function(m,x){var v=x===e.body.length-1;q(u,e,m,v,c,i,e.columns)}),u.applyStyles(u.userStyles),(r.showFoot==="lastPage"||r.showFoot==="everyPage")&&e.foot.forEach(function(m){return R(u,e,m,i,e.columns)})),Se(u,e,c,i),e.callEndPageHooks(u,i),e.finalY=i.y,t.lastAutoTable=e,u.applyStyles(u.userStyles)}function xt(t,e,r,a){var n=pt(t,e),i=e.settings;if(i.horizontalPageBreakBehaviour==="afterAllRows")n.forEach(function(o,u){t.applyStyles(t.userStyles),u>0?Y(t,e,r,a,o.columns,!0):ge(t,e,a,o.columns),vt(t,e,r,a,o.columns),te(t,e,a,o.columns)});else for(var l=-1,h=n[0],d=function(){var o=l;if(h){t.applyStyles(t.userStyles);var u=h.columns;l>=0?Y(t,e,r,a,u,!0):ge(t,e,a,u),o=me(t,e,l+1,a,u),te(t,e,a,u)}var c=o-l;n.slice(1).forEach(function(m){t.applyStyles(t.userStyles),Y(t,e,r,a,m.columns,!0),me(t,e,l+1,a,m.columns,c),te(t,e,a,m.columns)}),l=o};l<e.body.length-1;)d()}function ge(t,e,r,a){var n=e.settings;t.applyStyles(t.userStyles),(n.showHead==="firstPage"||n.showHead==="everyPage")&&e.head.forEach(function(i){return R(t,e,i,r,a)})}function vt(t,e,r,a,n){t.applyStyles(t.userStyles),e.body.forEach(function(i,l){var h=l===e.body.length-1;q(t,e,i,h,r,a,n)})}function me(t,e,r,a,n,i){t.applyStyles(t.userStyles),i=i??e.body.length;var l=Math.min(r+i,e.body.length),h=-1;return e.body.slice(r,l).forEach(function(d,o){var u=r+o===e.body.length-1,c=He(t,e,u,a);d.canEntireRowFit(c,n)&&(R(t,e,d,a,n),h=r+o)}),h}function te(t,e,r,a){var n=e.settings;t.applyStyles(t.userStyles),(n.showFoot==="lastPage"||n.showFoot==="everyPage")&&e.foot.forEach(function(i){return R(t,e,i,r,a)})}function yt(t,e,r){var a=r.getLineHeight(t.styles.fontSize),n=t.padding("vertical"),i=Math.floor((e-n)/a);return Math.max(0,i)}function bt(t,e,r,a){var n={};t.spansMultiplePages=!0,t.height=0;for(var i=0,l=0,h=r.columns;l<h.length;l++){var d=h[l],o=t.cells[d.index];if(o){Array.isArray(o.text)||(o.text=[o.text]);var u=new Fe(o.raw,o.styles,o.section);u=B(u,o),u.text=[];var c=yt(o,e,a);o.text.length>c&&(u.text=o.text.splice(c,o.text.length));var m=a.scaleFactor(),x=a.getLineHeightFactor();o.contentHeight=o.getContentHeight(m,x),o.contentHeight>=e&&(o.contentHeight=e,u.styles.minCellHeight-=e),o.contentHeight>t.height&&(t.height=o.contentHeight),u.contentHeight=u.getContentHeight(m,x),u.contentHeight>i&&(i=u.contentHeight),n[d.index]=u}}var v=new De(t.raw,-1,t.section,n,!0);v.height=i;for(var N=0,p=r.columns;N<p.length;N++){var d=p[N],u=v.cells[d.index];u&&(u.height=v.height);var o=t.cells[d.index];o&&(o.height=t.height)}return v}function wt(t,e,r,a){var n=t.pageSize().height,i=a.settings.margin,l=i.top+i.bottom,h=n-l;e.section==="body"&&(h-=a.getHeadHeight(a.columns)+a.getFootHeight(a.columns));var d=e.getMinimumRowHeight(a.columns,t),o=d<r;if(d>h)return console.log("Will not be able to print row ".concat(e.index," correctly since it's minimum height is larger than page height")),!0;if(!o)return!1;var u=e.hasRowSpan(a.columns),c=e.getMaxCellHeight(a.columns)>h;return c?(u&&console.log("The content of row ".concat(e.index," will not be drawn correctly since drawing rows with a height larger than the page height and has cells with rowspans is not supported.")),!0):!(u||a.settings.rowPageBreak==="avoid")}function q(t,e,r,a,n,i,l){var h=He(t,e,a,i);if(r.canEntireRowFit(h,l))R(t,e,r,i,l);else if(wt(t,r,h,e)){var d=bt(r,h,e,t);R(t,e,r,i,l),Y(t,e,n,i,l),q(t,e,d,a,n,i,l)}else Y(t,e,n,i,l),q(t,e,r,a,n,i,l)}function R(t,e,r,a,n){a.x=e.settings.margin.left;for(var i=0,l=n;i<l.length;i++){var h=l[i],d=r.cells[h.index];if(!d){a.x+=h.width;continue}t.applyStyles(d.styles),d.x=a.x,d.y=a.y;var o=e.callCellHooks(t,e.hooks.willDrawCell,d,r,h,a);if(o===!1){a.x+=h.width;continue}St(t,d,a);var u=d.getTextPos();ye(d.text,u.x,u.y,{halign:d.styles.halign,valign:d.styles.valign,maxWidth:Math.ceil(d.width-d.padding("left")-d.padding("right"))},t.getDocument()),e.callCellHooks(t,e.hooks.didDrawCell,d,r,h,a),a.x+=h.width}a.y+=r.height}function St(t,e,r){var a=e.styles;if(t.getDocument().setFillColor(t.getDocument().getFillColor()),typeof a.lineWidth=="number"){var n=je(a.lineWidth,a.fillColor);n&&t.rect(e.x,r.y,e.width,e.height,n)}else typeof a.lineWidth=="object"&&(a.fillColor&&t.rect(e.x,r.y,e.width,e.height,"F"),jt(t,e,r,a.lineWidth))}function jt(t,e,r,a){var n,i,l,h;a.top&&(n=r.x,i=r.y,l=r.x+e.width,h=r.y,a.right&&(l+=.5*a.right),a.left&&(n-=.5*a.left),d(a.top,n,i,l,h)),a.bottom&&(n=r.x,i=r.y+e.height,l=r.x+e.width,h=r.y+e.height,a.right&&(l+=.5*a.right),a.left&&(n-=.5*a.left),d(a.bottom,n,i,l,h)),a.left&&(n=r.x,i=r.y,l=r.x,h=r.y+e.height,a.top&&(i-=.5*a.top),a.bottom&&(h+=.5*a.bottom),d(a.left,n,i,l,h)),a.right&&(n=r.x+e.width,i=r.y,l=r.x+e.width,h=r.y+e.height,a.top&&(i-=.5*a.top),a.bottom&&(h+=.5*a.bottom),d(a.right,n,i,l,h));function d(o,u,c,m,x){t.getDocument().setLineWidth(o),t.getDocument().line(u,c,m,x,"S")}}function He(t,e,r,a){var n=e.settings.margin.bottom,i=e.settings.showFoot;return(i==="everyPage"||i==="lastPage"&&r)&&(n+=e.getFootHeight(e.columns)),t.pageSize().height-a.y-n}function Y(t,e,r,a,n,i){n===void 0&&(n=[]),i===void 0&&(i=!1),t.applyStyles(t.userStyles),e.settings.showFoot==="everyPage"&&!i&&e.foot.forEach(function(h){return R(t,e,h,a,n)}),e.callEndPageHooks(t,a);var l=e.settings.margin;Se(t,e,r,a),We(t),e.pageNumber++,a.x=l.left,a.y=l.top,r.y=l.top,e.callWillDrawPageHooks(t,a),e.settings.showHead==="everyPage"&&(e.head.forEach(function(h){return R(t,e,h,a,n)}),t.applyStyles(t.userStyles))}function We(t){var e=t.pageNumber();t.setPage(e+1);var r=t.pageNumber();return r===e?(t.addPage(),!0):!1}function kt(t){t.API.autoTable=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];var a=e[0],n=Pe(this,a),i=Ae(this,n);return Te(this,i),this},t.API.lastAutoTable=!1,t.API.autoTableText=function(e,r,a,n){ye(e,r,a,n,this)},t.API.autoTableSetDefaults=function(e){return I.setDefaults(e,this),this},t.autoTableSetDefaults=function(e,r){I.setDefaults(e,r)},t.API.autoTableHtmlToJson=function(e,r){var a;if(r===void 0&&(r=!1),typeof window>"u")return console.error("Cannot run autoTableHtmlToJson in non browser environment"),null;var n=new I(this),i=Ce(n,e,window,r,!1),l=i.head,h=i.body,d=((a=l[0])===null||a===void 0?void 0:a.map(function(o){return o.content}))||[];return{columns:d,rows:h,data:h}}}var ae;function Nt(t,e){var r=Pe(t,e),a=Ae(t,r);Te(t,a)}try{if(typeof window<"u"&&window){var pe=window,xe=pe.jsPDF||((ae=pe.jspdf)===null||ae===void 0?void 0:ae.jsPDF);xe&&kt(xe)}}catch(t){console.error("Could not apply autoTable plugin",t)}const z={HADIR:"hadir",TERLAMBAT:"terlambat",IZIN:"izin",SAKIT:"sakit",ALFA:"alfa"},_={[z.HADIR]:{label:"Hadir",color:"text-green-600 bg-green-100",dot:"bg-green-500"},[z.TERLAMBAT]:{label:"Terlambat",color:"text-yellow-600 bg-yellow-100",dot:"bg-yellow-500"},[z.IZIN]:{label:"Izin",color:"text-blue-600 bg-blue-100",dot:"bg-blue-500"},[z.SAKIT]:{label:"Sakit",color:"text-purple-600 bg-purple-100",dot:"bg-purple-500"},[z.ALFA]:{label:"Alfa",color:"text-red-600 bg-red-100",dot:"bg-red-500"}};function Ct(){const[t,e]=T.useState([]),[r,a]=T.useState(""),[n,i]=T.useState(new Date().toISOString().slice(0,10)),[l,h]=T.useState(!1),[d,o]=T.useState([]),[u,c]=T.useState(""),[m,x]=T.useState(null),[v,N]=T.useState(null);async function p(){try{const P=((await re.listKelas())?.data?.responseData??[]).map(D=>({id:D.kelas_id,label:`${D.tingkat} ${D.jurusan?.nama_jurusan??D.jurusan} ${D.paralel??""}`}));e(P),P.length>0&&!r&&a(P[0].id)}catch(g){console.error("Gagal ambil kelas:",g),N("Gagal memuat daftar kelas.")}}async function y(){if(r){h(!0),N(null);try{const P=((await $.lihatAbsensiSiswa({kelas_id:r,tanggal:n}))?.data?.responseData?.absensi??[]).map((D,K)=>({id:D.absensi_id||K,nis:D.nis,name:D.nama,status:D.status||D.jenis_absen,time:D.jam_datang||"-",note:D.keterangan||""}));o(P)}catch(g){console.error("Gagal ambil absensi:",g),N("Gagal memuat data absensi. Periksa koneksi atau konfigurasi API.")}finally{h(!1)}}}T.useEffect(()=>{p()},[]),T.useEffect(()=>{y()},[r,n]);const w=T.useMemo(()=>{const g={[z.HADIR]:0,[z.TERLAMBAT]:0,[z.IZIN]:0,[z.SAKIT]:0,[z.ALFA]:0};return d.forEach(j=>g[j.status]=(g[j.status]||0)+1),g},[d]),S=d.filter(g=>{const j=u.trim().toLowerCase();return m&&g.status!==m?!1:j?g.name.toLowerCase().includes(j)||g.nis.toLowerCase().includes(j)||(g.note||"").toLowerCase().includes(j):!0});function k(g){x(j=>j===g?null:g)}function C(){const g=[["NIS","Nama","Status","Waktu","Catatan"],...d.map(D=>[D.nis,D.name,_[D.status]?.label||D.status,D.time,D.note||""])],j=X.aoa_to_sheet(g),P=X.book_new();X.book_append_sheet(P,j,"Absensi"),_e(P,`absensi_${r}_${n}.xlsx`)}function W(){const g=new $e;g.setFontSize(14),g.text("Laporan Absensi Siswa",14,15),g.setFontSize(11),g.text(`Kelas: ${t.find(P=>P.id===Number(r))?.label||"-"} | Tanggal: ${n}`,14,23);const j=d.map(P=>[P.nis,P.name,_[P.status]?.label||P.status,P.time,P.note||""]);Nt(g,{head:[["NIS","Nama","Status","Waktu","Catatan"]],body:j,startY:30,theme:"striped",headStyles:{fillColor:[41,128,185]},styles:{fontSize:9}}),g.save(`absensi_${r}_${n}.pdf`)}return s.jsxs("div",{className:"flex flex-col p-6 md:p-8",children:[s.jsx("h2",{className:"mb-2 text-2xl font-bold text-gray-800",children:"Lihat Absensi"}),s.jsx("p",{className:"mb-6 text-gray-600 text-sm",children:"Daftar siswa per kelas & per hari — pilih kelas dan tanggal untuk melihat rekap."}),s.jsxs("div",{className:"flex flex-wrap items-end gap-3 mb-4",children:[s.jsxs("div",{className:"flex flex-col text-sm",children:[s.jsx("label",{className:"text-gray-700 font-medium",children:"Kelas"}),s.jsxs("select",{value:r,onChange:g=>a(g.target.value),className:"mt-1 p-2 border border-gray-300 rounded-lg focus:ring focus:ring-blue-200",children:[s.jsx("option",{value:"",children:"Pilih kelas"}),t.map(g=>s.jsx("option",{value:g.id,children:g.label},g.id))]})]}),s.jsxs("div",{className:"flex flex-col text-sm",children:[s.jsx("label",{className:"text-gray-700 font-medium",children:"Tanggal"}),s.jsx("input",{type:"date",value:n,onChange:g=>i(g.target.value),className:"mt-1 p-2 border border-gray-300 rounded-lg focus:ring focus:ring-blue-200"})]}),s.jsx("button",{onClick:y,className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg text-sm font-medium",children:"Muat ulang"}),s.jsxs("div",{className:"ml-auto flex gap-2",children:[s.jsx("button",{onClick:C,className:"bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg text-sm font-medium",children:"Export Excel"}),s.jsx("button",{onClick:W,className:"bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded-lg text-sm font-medium",children:"Export PDF"})]})]}),s.jsxs("div",{className:"flex flex-wrap gap-2 mb-4",children:[Object.keys(_).map(g=>s.jsxs("button",{onClick:()=>k(g),className:`flex items-center gap-2 px-3 py-2 rounded-lg border text-sm transition
              ${m===g?"border-blue-500 bg-blue-50":"border-gray-200 bg-white hover:bg-gray-50"}`,children:[s.jsx("span",{className:`w-2.5 h-2.5 rounded-full ${_[g].dot}`}),s.jsx("span",{className:"font-semibold",children:_[g].label}),s.jsxs("span",{className:"text-gray-500 text-xs",children:["(",w[g]||0,")"]})]},g)),s.jsx("input",{placeholder:"Cari nama atau NIS...",value:u,onChange:g=>c(g.target.value),className:"ml-auto border border-gray-300 rounded-lg px-3 py-2 text-sm focus:ring focus:ring-blue-200"})]}),s.jsxs("div",{className:"border border-gray-200 rounded-lg overflow-hidden bg-white shadow-sm",children:[s.jsxs("div",{className:"flex justify-between items-center px-4 py-3 border-b border-gray-100 text-sm",children:[s.jsxs("div",{children:["Rekap:"," ",s.jsx("span",{className:"font-semibold",children:t.find(g=>g.id===Number(r))?.label||"-"})," ","— ",s.jsx("span",{className:"font-semibold",children:n})]}),s.jsxs("div",{className:"text-gray-600",children:["Total siswa: ",s.jsx("strong",{children:d.length})]})]}),l?s.jsx(Re,{rows:8,columns:5}):v?s.jsx("div",{className:"p-6 text-center text-red-500",children:v}):d.length===0?s.jsx("div",{className:"p-6 text-center text-gray-500",children:"Belum ada data absensi."}):S.length===0?s.jsx("div",{className:"p-6 text-center text-gray-500",children:"Tidak ada hasil untuk filter saat ini."}):s.jsxs("table",{className:"table-base",children:[s.jsx("thead",{className:"table-thead",children:s.jsxs("tr",{children:[s.jsx("th",{className:"table-th",children:"No"}),s.jsx("th",{className:"table-th",children:"NIS"}),s.jsx("th",{className:"table-th",children:"Nama"}),s.jsx("th",{className:"table-th",children:"Status"}),s.jsx("th",{className:"table-th",children:"Waktu"}),s.jsx("th",{className:"table-th",children:"Catatan"})]})}),s.jsx("tbody",{className:"table-tbody",children:S.map((g,j)=>s.jsxs("tr",{className:"table-tr hover:bg-gray-50 transition",children:[s.jsx("td",{className:"table-td",children:j+1}),s.jsx("td",{className:"table-td",children:g.nis}),s.jsx("td",{className:"table-td",children:g.name}),s.jsx("td",{className:"table-td",children:s.jsxs("span",{className:`inline-flex items-center gap-2 px-2 py-1 rounded-full font-medium ${_[g.status]?.color}`,children:[s.jsx("span",{className:`w-2.5 h-2.5 rounded-full ${_[g.status]?.dot}`}),_[g.status]?.label||g.status]})}),s.jsx("td",{className:"table-td",children:g.time}),s.jsx("td",{className:"table-td",children:g.note})]},g.id))})]})]})]})}const Lt=Object.freeze(Object.defineProperty({__proto__:null,default:Ct},Symbol.toStringTag,{value:"Module"}));function Pt(t,e){const[r,a]=T.useState(t);return T.useEffect(()=>{const n=setTimeout(()=>{a(t)},e);return()=>{clearTimeout(n)}},[t,e]),r}const Dt=()=>{const[t,e]=A.useState([]),[r,a]=A.useState(!0),[n,i]=A.useState(null),[l,h]=A.useState([]),[d,o]=A.useState(""),[u,c]=A.useState(""),[m]=A.useState(new Date().toISOString().slice(0,10)),[x,v]=A.useState(""),[N,p]=A.useState({}),[y,w]=A.useState(!1),[S,k]=A.useState([]),[C,W]=A.useState(""),[g,j]=A.useState(null),[P,D]=A.useState("hadir"),[K,oe]=A.useState(!1),[ze,le]=A.useState(!1),U=Pt(C,500);A.useEffect(()=>{(async()=>{try{const F=(await re.listKelas())?.data?.responseData??[];console.log("raw data:",F);const H=F.map(O=>({id:O.kelas_id,label:`${O.tingkat||""} ${O.jurusan?.nama_jurusan||""} ${O.paralel||""}`.trim()}));console.log("kelasList:",H),h(H)}catch{h([])}})()},[]);const Z=A.useCallback(async()=>{a(!0),i(null);try{const f={tanggal:m};d&&(f.kelas_id=d),u&&(f.status=u);const b=await $.lihatAbsensiSiswa(f),F=b?.data?.responseData?.absensi??[];console.log("=== FETCH ABSENSI DEBUG ==="),console.log("Raw response:",b?.data),console.log("Absensi data:",F),console.log("Is array?",Array.isArray(F)),Array.isArray(F)&&F.length>0&&(console.log("First item:",F[0]),console.log("First item absensi_id type:",typeof F[0].absensi_id,F[0].absensi_id),console.log("First item nis type:",typeof F[0].nis,F[0].nis)),e(Array.isArray(F)?F:[])}catch(f){console.error("Error fetching absensi:",f),i(f.message||"Terjadi kesalahan saat memuat data"),e([])}finally{a(!1)}},[d,u,m]);A.useEffect(()=>{Z()},[Z]),A.useEffect(()=>{if(!y)return;if(!U){k([]);return}(async()=>{le(!0);try{const b=await re.getDataSiswa({query:U});b.data?.responseStatus?k(b.data.responseData):k([])}catch(b){console.error("Gagal memuat data siswa",b),k([])}finally{le(!1)}})()},[U,y]);const Le=async()=>{if(!g){L.fire("Peringatan","Pilih siswa terlebih dahulu","warning");return}oe(!0);try{const f=t.find(b=>b.siswa_id===g.siswa_id);f?await $.updateAbsensiStatusAll({absensi_id:f.absensi_id,status:P}):await $.updateAbsensiStatusAll({siswa_id:g.siswa_id,tanggal:m,status:P}),L.fire({icon:"success",title:"Berhasil",text:`Absensi ${g.nama} berhasil dicatat sebagai ${P}`,timer:2e3,showConfirmButton:!1}),w(!1),j(null),W(""),D("hadir"),Z()}catch(f){console.error(f);const b=f?.response?.data?.responseMessage||"Gagal mencatat absensi";L.fire("Gagal",b,"error")}finally{oe(!1)}},de=A.useMemo(()=>{if(!C)return[];const f=C.toLowerCase();return S.filter(b=>b.nis&&b.nis.toLowerCase().includes(f)||b.nama&&b.nama.toLowerCase().includes(f)).slice(0,10)},[C,S]),Be=async(f,b,F,H)=>{if((await L.fire({title:"Konfirmasi Perubahan Status",html:`
        <div class="text-sm">
          <p><strong>Siswa:</strong> ${H}</p>
          <p><strong>Status Lama:</strong> <span class="capitalize">${F}</span></p>
          <p><strong>Status Baru:</strong> <span class="capitalize">${b}</span></p>
        </div>
      `,icon:"question",showCancelButton:!0,confirmButtonColor:"#3b82f6",cancelButtonColor:"#6b7280",confirmButtonText:"Ya, Ubah Status",cancelButtonText:"Batal"})).isConfirmed){p(M=>({...M,[f]:!0}));try{await $.updateAbsensiStatusAll({absensi_id:f,status:b}),e(M=>M.map(Q=>Q.absensi_id===f?{...Q,status:b}:Q)),L.fire({icon:"success",title:"Status Berhasil Diubah!",text:`Status kehadiran ${H} berhasil diubah menjadi ${b}`,confirmButtonColor:"#3b82f6",timer:3e3,timerProgressBar:!0})}catch(M){console.error("Error updating status:",M),L.fire({icon:"error",title:"Gagal Mengubah Status",text:M?.response?.data?.responseMessage||"Terjadi kesalahan saat mengubah status",confirmButtonColor:"#3b82f6"})}finally{p(M=>({...M,[f]:!1}))}}},he=({item:f})=>{const b=[{value:"hadir",label:"Hadir",color:"text-green-600"},{value:"terlambat",label:"Terlambat",color:"text-yellow-600"},{value:"izin",label:"Izin",color:"text-blue-600"},{value:"sakit",label:"Sakit",color:"text-red-600"},{value:"alfa",label:"Alfa",color:"text-gray-600"}],F=N[f.absensi_id];return s.jsxs("div",{className:"relative",children:[s.jsx("select",{value:f.status,onChange:H=>Be(f.absensi_id,H.target.value,f.status,f.nama),disabled:F,className:`
            w-full px-2 sm:px-3 py-1 sm:py-1.5 text-xs font-medium border border-gray-300 rounded-md
            focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500
            ${F?"bg-gray-100 cursor-not-allowed":"bg-white cursor-pointer hover:bg-gray-50"}
            transition-colors duration-200
          `,children:b.map(H=>s.jsx("option",{value:H.value,children:H.label},H.value))}),F&&s.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-white bg-opacity-75 rounded-md",children:s.jsx("svg",{className:"w-3 h-3 sm:w-4 sm:h-4 animate-spin text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})})]})},E=t.filter(f=>{if(u&&String(f.status||"").toLowerCase()!==String(u||"").toLowerCase())return!1;const b=x.trim().toLowerCase();if(!b)return!0;const F=String(f.nis||"").toLowerCase(),H=String(f.nama||"").toLowerCase();return F.includes(b)||H.includes(b)});return console.log("=== FILTERED DATA DEBUG ==="),console.log("Filtered count:",E.length),E.length>0&&(console.log("First filtered item:",E[0]),console.log("Keys:",Object.keys(E[0]))),r?s.jsx(ve,{text:"Loading..."}):n?s.jsx(Ee,{message:n}):s.jsxs("div",{className:"flex flex-col p-4 sm:p-6 md:p-8",children:[s.jsx("div",{className:"mb-4 sm:mb-6",children:s.jsxs("div",{className:"flex justify-between items-center mb-2",children:[s.jsx("h1",{className:"text-xl sm:text-2xl font-bold",children:"Absensi Siswa Hari Ini"}),s.jsxs("button",{onClick:()=>w(!0),className:"bg-blue-600 text-white px-4 py-2 rounded-lg text-sm font-medium hover:bg-blue-700 transition-colors shadow-sm flex items-center gap-2",children:[s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Absensi Manual"]})]})}),s.jsxs("div",{className:"mb-4 space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Filter Kelas"}),s.jsxs("select",{value:d,onChange:f=>o(f.target.value),className:"w-full border border-gray-300 rounded-lg px-3 py-2 text-sm",children:[s.jsx("option",{value:"",children:"Semua Kelas"}),l.map(f=>s.jsx("option",{value:f.id,children:f.label},f.id))]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Status Kehadiran"}),s.jsx("div",{className:"grid grid-cols-3 sm:flex sm:flex-wrap gap-2",children:["","hadir","terlambat","izin","sakit","alfa"].map(f=>s.jsx("button",{onClick:()=>c(f),className:`px-2 sm:px-3 py-1.5 rounded-md text-xs sm:text-sm border transition-colors ${u===f?"bg-blue-600 text-white border-blue-600":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,children:f?f.charAt(0).toUpperCase()+f.slice(1):"Semua"},f||"semua"))})]}),s.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[s.jsxs("div",{className:"flex-1",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Cari NIS/Nama"}),s.jsx("input",{value:x,onChange:f=>v(f.target.value),placeholder:"Masukkan NIS atau nama siswa",className:"w-full border border-gray-300 rounded-lg px-3 py-2 text-sm"})]}),s.jsx("div",{className:"flex items-end",children:s.jsx("button",{onClick:()=>{o(""),c(""),v("")},className:"w-full sm:w-auto px-4 py-2 border border-gray-300 rounded-lg text-sm hover:bg-gray-50 transition-colors",children:"Reset Filter"})})]})]}),s.jsxs("div",{className:"text-xs text-gray-600 mb-3 p-2 bg-gray-50 rounded-md",children:[s.jsx("span",{className:"font-medium",children:"Filter aktif:"}),s.jsxs("span",{className:"ml-1",children:["Kelas: ",d?l.find(f=>String(f.id||"")===String(d||""))?.label:"Semua"]}),s.jsx("span",{className:"mx-1",children:"•"}),s.jsxs("span",{children:["Status: ",u||"Semua"]})]}),s.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:[s.jsx("div",{className:"block sm:hidden",children:E.length===0?s.jsx("div",{className:"p-4 text-center text-gray-500",children:u?`Belum ada data siswa yang ${u}`:"Belum ada data absensi hari ini"}):s.jsx("div",{className:"divide-y divide-gray-200",children:E.map((f,b)=>s.jsxs("div",{className:"p-4",children:[s.jsxs("div",{className:"flex justify-between items-start mb-2",children:[s.jsxs("div",{children:[s.jsx("div",{className:"font-medium text-gray-900",children:f.nama}),s.jsxs("div",{className:"text-sm text-gray-500",children:["NIS: ",f.nis]})]}),s.jsxs("div",{className:"text-xs text-gray-500",children:["#",b+1]})]}),s.jsxs("div",{className:"text-sm text-gray-600 mb-3",children:[f.tingkat," ",f.jurusan?.nama_jurusan||""," ",f.paralel||""]}),s.jsxs("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[s.jsxs("div",{children:[s.jsx("div",{className:"text-gray-500 mb-1",children:"Status"}),s.jsx(he,{item:f})]}),s.jsxs("div",{children:[s.jsx("div",{className:"text-gray-500 mb-1",children:"Jam Datang"}),s.jsx("div",{className:"font-medium",children:f.jam_datang||"-"})]})]}),s.jsxs("div",{className:"mt-2 text-sm",children:[s.jsx("div",{className:"text-gray-500 mb-1",children:"Jam Pulang"}),s.jsx("div",{className:"font-medium",children:f.jam_pulang||"-"})]})]},`mobile-${b}-${f.absensi_id||""}-${f.nis||""}`))})}),s.jsx("div",{className:"hidden sm:block overflow-x-auto",children:s.jsxs("table",{className:"table-base",children:[s.jsx("thead",{className:"table-thead",children:s.jsxs("tr",{children:[s.jsx("th",{className:"table-th",children:"No"}),s.jsx("th",{className:"table-th",children:"NIS"}),s.jsx("th",{className:"table-th",children:"Nama"}),s.jsx("th",{className:"table-th",children:"Kelas"}),s.jsx("th",{className:"table-th",children:"Status"}),s.jsx("th",{className:"table-th",children:"Jam Datang"}),s.jsx("th",{className:"table-th",children:"Jam Pulang"})]})}),s.jsx("tbody",{className:"table-tbody",children:E.length===0?s.jsx("tr",{children:s.jsx("td",{className:"table-td text-center",colSpan:7,children:u?`Belum ada data siswa yang ${u}`:"Belum ada data absensi hari ini"})}):E.map((f,b)=>s.jsxs("tr",{className:"table-tr",children:[s.jsx("td",{className:"table-td",children:b+1}),s.jsx("td",{className:"table-td",children:f.nis}),s.jsx("td",{className:"table-td",children:f.nama}),s.jsxs("td",{className:"table-td",children:[f.tingkat," ",f.jurusan?.nama_jurusan||""," ",f.paralel||""]}),s.jsx("td",{className:"table-td",children:s.jsx(he,{item:f})}),s.jsx("td",{className:"table-td",children:f.jam_datang||"-"}),s.jsx("td",{className:"table-td",children:f.jam_pulang||"-"})]},`desktop-${b}-${f.absensi_id||""}-${f.nis||""}`))})]})})]}),y&&s.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm",children:s.jsxs("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-md flex flex-col animate-fade-in max-h-[90vh]",children:[s.jsxs("div",{className:"p-5 border-b border-gray-100 flex justify-between items-center rounded-t-xl bg-white",children:[s.jsx("h3",{className:"text-lg font-bold text-gray-800",children:"Absensi Manual"}),s.jsx("button",{onClick:()=>w(!1),className:"text-gray-400 hover:text-gray-600 transition-colors",children:s.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),s.jsxs("div",{className:"p-5 space-y-4 overflow-y-auto",children:[s.jsxs("div",{className:"relative",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Cari Siswa (NIS / Nama)"}),s.jsxs("div",{className:"relative",children:[s.jsx("input",{type:"text",value:g?g.nama:C,onChange:f=>{W(f.target.value),j(null)},placeholder:"Ketik NIS atau Nama...",className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none",autoFocus:!0}),s.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:s.jsx("svg",{className:"w-5 h-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),g&&s.jsx("button",{onClick:()=>{j(null),W("")},className:"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-400 hover:text-gray-600",children:s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),!g&&C&&s.jsx("div",{className:"absolute z-50 w-full mt-1 bg-white border border-gray-200 rounded-lg shadow-xl max-h-60 overflow-y-auto",children:de.length>0?de.map((f,b)=>s.jsxs("button",{onClick:()=>{j(f),W(f.nama)},className:"w-full text-left px-4 py-2 hover:bg-gray-50 flex flex-col border-b border-gray-50 last:border-0",children:[s.jsx("span",{className:"font-medium text-gray-800",children:f.nama}),s.jsxs("span",{className:"text-xs text-gray-500",children:["NIS: ",f.nis," • ",f.kelas?.tingkat||""," ",f.kelas?.jurusan?.nama_jurusan||""," ",f.kelas?.paralel||""]})]},`siswa-${b}-${f.siswa_id||""}-${f.nis||""}`)):s.jsx("div",{className:"p-3 text-center text-gray-500 text-sm",children:ze?"Mencari...":S.length===0&&!U?"Ketik nama/NIS untuk mencari":"Tidak ditemukan"})})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status Kehadiran"}),s.jsx("div",{className:"grid grid-cols-2 gap-2",children:["hadir","izin","sakit","terlambat","alfa"].map(f=>s.jsx("button",{onClick:()=>D(f),className:`px-3 py-2 rounded-lg text-sm font-medium border transition-all ${P===f?"bg-blue-600 text-white border-blue-600 shadow-md":"bg-white text-gray-600 border-gray-200 hover:bg-gray-50"} capitalize`,children:f},f))})]}),g&&s.jsxs("div",{className:"bg-blue-50 border border-blue-100 rounded-lg p-3",children:[s.jsx("p",{className:"text-sm text-blue-800 font-medium",children:"Konfirmasi:"}),s.jsxs("p",{className:"text-sm text-blue-600",children:["Siswa ",s.jsx("strong",{children:g.nama})," (NIS: ",g.nis,") akan dicatat sebagai ",s.jsx("strong",{className:"capitalize",children:P}),"."]})]})]}),s.jsxs("div",{className:"p-5 border-t border-gray-100 flex justify-end gap-3 bg-gray-50 rounded-b-xl",children:[s.jsx("button",{onClick:()=>w(!1),className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:"Batal"}),s.jsx("button",{onClick:Le,disabled:!g||K,className:`px-4 py-2 text-sm font-medium text-white rounded-lg shadow-sm flex items-center gap-2 ${!g||K?"bg-blue-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700"}`,children:K?s.jsxs(s.Fragment,{children:[s.jsxs("svg",{className:"w-4 h-4 animate-spin",fill:"none",viewBox:"0 0 24 24",children:[s.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),s.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Menyimpan..."]}):"Simpan Absensi"})]})]})})]})},Bt=Object.freeze(Object.defineProperty({__proto__:null,default:Dt},Symbol.toStringTag,{value:"Module"}));function Ft(){const[t,e]=T.useState([]),[r,a]=T.useState(!0),[n,i]=T.useState(null),[l,h]=T.useState(null),[d,o]=T.useState(null),[u,c]=T.useState("all");T.useEffect(()=>{m()},[]);async function m(){a(!0),i(null);try{const y=(await $.getSiswaIzinSakit())?.data?.responseData?.siswa_izin_sakit??[];console.log("Siswa Izin Sakit:",y),e(y)}catch(p){console.error(p),i("Gagal memuat data. Periksa koneksi atau konfigurasi API.")}finally{a(!1)}}function x(p){if(!p)return null;if(p.startsWith("http"))return p;let y=Me.defaults.baseURL||window.location.origin;y=y.replace(/\/api\/?$/,"");const w=p.replace(/^\/+/,""),S=w.startsWith("storage")?w:`storage/${w}`;return`${y}/${S}`}async function v(p,y){let w="",S="",k="",C="";switch(y){case"sakit":w="Tandai Sakit?",S="Siswa akan ditandai sebagai Sakit.",k="Ya, Tandai Sakit",C="#EF4444";break;case"izin":w="Tandai Izin?",S="Siswa akan ditandai sebagai Izin.",k="Ya, Tandai Izin",C="#3B82F6";break;case"alfa":w="Tolak Pengajuan?",S="Pengajuan akan ditolak dan status menjadi Alfa.",k="Ya, Tolak",C="#4B5563";break;default:w="Konfirmasi Update",S=`Ubah status menjadi ${y}?`,k="Ya, Update",C="#3085d6"}if((await L.fire({title:w,text:S,icon:"warning",showCancelButton:!0,confirmButtonColor:C,cancelButtonColor:"#d33",confirmButtonText:k,cancelButtonText:"Batal"})).isConfirmed){h(p);try{await $.updateAbsensiStatus({absensi_id:p,status:y}),e(g=>g.filter(j=>j.absensi_id!==p)),L.fire({title:"Berhasil!",text:"Status berhasil diperbarui.",icon:"success",timer:1500,showConfirmButton:!1})}catch(g){console.error(g),L.fire({title:"Gagal!",text:"Gagal memperbarui status. Periksa konfigurasi API atau jaringan.",icon:"error"})}finally{h(null)}}}if(r)return s.jsx(ve,{text:"Memuat data user..."});if(n)return s.jsxs("div",{className:"p-5 text-red-600",children:["Error: ",n,s.jsx("div",{className:"mt-2",children:s.jsx("button",{onClick:m,className:"px-4 py-2 text-white transition-colors bg-blue-500 rounded hover:bg-blue-600",children:"Coba lagi"})})]});const N=t.filter(p=>u==="all"?!0:p.status===u);return s.jsxs("div",{className:"flex flex-col p-6 md:p-8",children:[s.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between mb-6 gap-4",children:[s.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"Daftar Siswa Izin / Sakit"}),s.jsxs("div",{className:"flex space-x-2 bg-gray-100 p-1 rounded-lg",children:[s.jsx("button",{onClick:()=>c("all"),className:`px-4 py-2 text-sm font-medium rounded-md transition-colors ${u==="all"?"bg-white text-gray-900 shadow-sm":"text-gray-500 hover:text-gray-900"}`,children:"Semua"}),s.jsx("button",{onClick:()=>c("izin"),className:`px-4 py-2 text-sm font-medium rounded-md transition-colors ${u==="izin"?"bg-white text-blue-600 shadow-sm":"text-gray-500 hover:text-gray-900"}`,children:"Izin"}),s.jsx("button",{onClick:()=>c("sakit"),className:`px-4 py-2 text-sm font-medium rounded-md transition-colors ${u==="sakit"?"bg-white text-red-600 shadow-sm":"text-gray-500 hover:text-gray-900"}`,children:"Sakit"})]})]}),N.length===0?s.jsx("div",{className:"p-6 text-gray-600 text-center",children:u==="all"?"Tidak ada pengajuan izin atau sakit yang perlu diverifikasi.":`Tidak ada pengajuan ${u} saat ini.`}):s.jsx("div",{className:"grid grid-cols-1 gap-6 md:grid-cols-2 lg:grid-cols-3",children:N.map(p=>{const y=x(p.bukti),w=p.siswa??{},S=l===p.absensi_id;let k="",C="";switch(p.status){case"pending":k="bg-yellow-100",C="text-yellow-800";break;case"sakit":k="bg-red-100",C="text-red-800";break;case"izin":k="bg-green-100",C="text-green-800";break;case"rejected":k="bg-gray-200",C="text-gray-600";break;default:k="bg-gray-200",C="text-gray-700"}const W=String(p.jenis_absen??"").toLowerCase(),g=W==="sakit"?"bg-red-50 border-red-300":W==="izin"?"bg-blue-50 border-blue-300":"bg-white border-gray-100";return s.jsxs("div",{className:`flex flex-col overflow-hidden transition-all duration-200 shadow-lg rounded-xl hover:shadow-xl border-l-4 ${g}`,children:[s.jsx("div",{className:"flex items-center justify-center w-full h-48 overflow-hidden bg-gray-200 cursor-pointer",onClick:()=>y&&o(y),children:y?s.jsx("img",{src:y,alt:`bukti-${p.absensi_id}`,className:"object-cover w-full h-full transition-transform hover:scale-105",onError:j=>{j.currentTarget.style.display="none",j.currentTarget.parentElement.innerHTML='<div class="text-gray-500 text-sm">Gagal memuat bukti</div>'}}):s.jsx("div",{className:"text-sm text-gray-500",children:"Tidak ada bukti"})}),s.jsxs("div",{className:"flex flex-col flex-grow p-5",children:[s.jsxs("div",{className:"flex items-start justify-between mb-3",children:[s.jsxs("div",{children:[s.jsx("div",{className:"text-lg font-semibold leading-tight text-gray-900",children:w.nama??"—"}),s.jsxs("div",{className:"mt-1 text-sm text-gray-500",children:["NIS ",w.nis??"—"," - Kelas:"," ",w.kelas?`${w.kelas.tingkat??""} ${w.kelas.jurusan?.nama_jurusan??""} ${w.kelas.paralel??""}`:"—"]}),s.jsxs("div",{children:["Keterangan: ",p.keterangan??"—"]})]}),s.jsx("span",{className:`text-xs font-semibold px-3 py-1 rounded-full capitalize ${k} ${C}`,children:p.status??"—"})]}),s.jsxs("div",{className:"pt-3 mt-auto text-xs text-gray-500 border-t border-gray-100",children:["Diajukan:"," ",new Date(p.created_at??p.tanggal).toLocaleString()]}),s.jsxs("div",{className:"flex flex-wrap gap-2 mt-4",children:[p.status=="sakit"&&s.jsx("button",{onClick:()=>v(p.absensi_id,"sakit"),disabled:S,className:`flex-1 px-3 py-2 text-sm font-medium rounded-lg transition-colors duration-200 
                                                        ${S?"bg-gray-300 text-gray-600 cursor-not-allowed":"bg-red-500 text-white hover:bg-red-600"}`,children:"Tandai Sakit"}),p.status=="izin"&&s.jsx("button",{onClick:()=>v(p.absensi_id,"izin"),disabled:S,className:`flex-1 px-3 py-2 text-sm font-medium rounded-lg transition-colors duration-200 
                                                        ${S?"bg-gray-300 text-gray-600 cursor-not-allowed":"bg-blue-500 text-white hover:bg-blue-600"}`,children:"Tandai Izin"}),s.jsx("button",{onClick:()=>v(p.absensi_id,"alfa"),disabled:S||p.status==="alfa",className:`flex-1 px-3 py-2 text-sm font-medium rounded-lg transition-colors duration-200 
                                                    ${S||p.status==="alfa"?"bg-gray-300 text-gray-600 cursor-not-allowed":"bg-gray-600 text-white hover:bg-gray-700"}`,children:"Tolak"})]})]})]},p.absensi_id)})}),d&&s.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/80",onClick:()=>o(null),children:s.jsxs("div",{className:"relative max-w-4xl max-h-[90vh] p-2",children:[s.jsx("button",{className:"absolute -top-10 right-0 text-white hover:text-gray-300 text-2xl font-bold",onClick:()=>o(null),children:"×"}),s.jsx("img",{src:d,alt:"Full Preview",className:"max-w-full max-h-[85vh] object-contain rounded-md"})]})})]})}const Rt=Object.freeze(Object.defineProperty({__proto__:null,default:Ft},Symbol.toStringTag,{value:"Module"}));export{Lt as L,Rt as S,Nt as a,Bt as b};
