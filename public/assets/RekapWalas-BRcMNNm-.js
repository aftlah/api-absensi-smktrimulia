import{j as a}from"./query-vendor-CL32O2jR.js";import{r as t}from"./router-vendor-CjMceo_z.js";import{b as N,g as u}from"./admin-pages-BGiHTXEV.js";import"./ui-vendor-DAzBgmXi.js";import"./react-vendor-BZoW56qi.js";import"./utils-vendor-BmMXCZbk.js";const g=s=>{const l=i=>String(i).padStart(2,"0");return`${s.getFullYear()}-${l(s.getMonth()+1)}-${l(s.getDate())}`};function D(){const{user:s}=N(),[l,i]=t.useState(()=>new Date),[p,o]=t.useState(null),[c,m]=t.useState([]),[j,x]=t.useState(!1),[h,b]=t.useState(""),n=t.useMemo(()=>{const e={hadir:0,terlambat:0,izin:0,sakit:0,alfa:0};return c.forEach(r=>{const d=(r.status||"").toLowerCase();e[d]!==void 0&&(e[d]+=1)}),e},[c]),y=async()=>{if(s?.role==="walas")try{const e=await u.walasInfo(),r=e?.data?.responseData||e?.data?.data||null;o(r)}catch{o(null)}},f=async()=>{x(!0),b("");try{const e=await u.lihatAbsensiSiswa({tanggal:g(l)}),d=(e?.data?.responseData||e?.data||{})?.absensi||[];m(Array.isArray(d)?d:[])}catch{b("Gagal memuat rekap kelas wali."),m([])}finally{x(!1)}};return t.useEffect(()=>{y()},[s?.role]),t.useEffect(()=>{f()},[l]),a.jsx("div",{className:"min-h-screen bg-gray-50",children:a.jsxs("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[a.jsx("div",{className:"mb-6 p-6 bg-white rounded-xl shadow-sm border border-gray-200",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Rekap Absensi Kelas Wali"}),a.jsx("p",{className:"text-sm text-gray-600",children:p?.kelas_label||"Memuat info kelas..."})]}),a.jsx("input",{type:"date",value:g(l),onChange:e=>i(new Date(e.target.value)),className:"px-3 py-1.5 border border-gray-300 rounded-md text-sm"})]})}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4 mb-8",children:[{key:"hadir",label:"Hadir",color:"bg-green-100 text-green-700",value:n.hadir},{key:"terlambat",label:"Terlambat",color:"bg-yellow-100 text-yellow-700",value:n.terlambat},{key:"izin",label:"Izin",color:"bg-blue-100 text-blue-700",value:n.izin},{key:"sakit",label:"Sakit",color:"bg-red-100 text-red-700",value:n.sakit},{key:"alfa",label:"Alfa",color:"bg-gray-100 text-gray-700",value:n.alfa}].map(e=>a.jsxs("div",{className:`p-4 rounded-xl border border-gray-200 shadow-sm ${e.color}`,children:[a.jsx("p",{className:"text-sm font-medium",children:e.label}),a.jsx("p",{className:"text-2xl font-bold",children:e.value})]},e.key))}),a.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden",children:a.jsx("div",{className:"overflow-x-auto",children:j?a.jsx("p",{className:"p-4 text-sm text-gray-500",children:"Memuat data rekap..."}):h?a.jsx("p",{className:"p-4 text-sm text-red-600",children:h}):c.length===0?a.jsx("p",{className:"table-empty",children:"Tidak ada data absensi untuk tanggal ini."}):a.jsxs("table",{className:"table-base",children:[a.jsx("thead",{className:"table-thead",children:a.jsxs("tr",{children:[a.jsx("th",{className:"table-th",children:"NIS"}),a.jsx("th",{className:"table-th",children:"Nama"}),a.jsx("th",{className:"table-th",children:"Status"}),a.jsx("th",{className:"table-th",children:"Jam Datang"}),a.jsx("th",{className:"table-th",children:"Jam Pulang"})]})}),a.jsx("tbody",{className:"table-tbody",children:c.map((e,r)=>a.jsxs("tr",{className:"table-tr hover:bg-gray-50",children:[a.jsx("td",{className:"table-td",children:e.nis||"-"}),a.jsx("td",{className:"table-td",children:e.nama||"-"}),a.jsx("td",{className:"table-td capitalize",children:e.status||"-"}),a.jsx("td",{className:"table-td",children:e.jam_datang||"-"}),a.jsx("td",{className:"table-td",children:e.jam_pulang||"-"})]},r))})]})})})]})})}export{D as default};
